<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re: [PATCH bpf] tools/bpf: fix bpftool build with OUTPUT set -->
<!--X-From-R13: Xnxho Yvpvafxv &#60;wnxho.xvpvafxvNargebabzr.pbz> -->
<!--X-Date: Fri, 19 Jul 2019 11:17:22 &#45;0700 -->
<!--X-Message-Id: 20190719111716.1cbf62d1@cakuba.netronome.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CACAyw9&#45;CWRHVH3TJ=Tke2x8YiLsH47sLCijdp=V+5M836R9aAA@mail.gmail.com -->
<!--X-Reference: 20190718142041.83342&#45;1&#45;iii@linux.ibm.com -->
<!--X-Reference: 20190718115111.643027cf@cakuba.netronome.com -->
<!--X-Reference: 43FB794B&#45;6200&#45;4560&#45;BF10&#45;BBF4B9247913@linux.ibm.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="BPF: Re: [PATCH bpf] tools/bpf: fix bpftool build with OUTPUT set">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Re: [PATCH bpf] tools/bpf: fix bpftool build with OUTPUT set &mdash; BPF</title>
<link rel="alternate" type="application/rss+xml" title="BPF" href="//feeds.feedburner.com/packetfilters">
<script type="text/javascript">
var addthis_config = addthis_config||{};
addthis_config.data_track_addressbar = false;
</script>
</head>
<body itemscope itemtype="//schema.org/Article" bgcolor=white vlink=green link=blue>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">Re: [PATCH bpf] tools/bpf: fix bpftool build with OUTPUT set</h1>
[<a href="msg05556.html">Date Prev</a>][<a href="msg05558.html">Date Next</a>][<a href="msg05526.html">Thread Prev</a>][<a href="msg05502.html">Thread Next</a>][<a href="maillist.html#05557">Date Index</a>][<a href="index.html#05557">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: Re: [PATCH bpf] tools/bpf: fix bpftool build with OUTPUT set</li>
<li><em>From</em>: Jakub Kicinski &lt;jakub.kicinski@xxxxxxxxxxxxx&gt;</li>
<li><em>Date</em>: Fri, 19 Jul 2019 11:17:16 -0700</li>
<li><em>Cc</em>: bpf@xxxxxxxxxxxxxxx, netdev@xxxxxxxxxxxxxxx, lmb@xxxxxxxxxxxxxx,        gor@xxxxxxxxxxxxx, heiko.carstens@xxxxxxxxxx,        Arnaldo Carvalho de Melo &lt;acme@xxxxxxxxxx&gt;</li>
<li><em>In-reply-to</em>: &lt;<a href="msg05526.html">43FB794B-6200-4560-BF10-BBF4B9247913@linux.ibm.com</a>&gt;</li>
<li><em>Organization</em>: Netronome Systems, Ltd.</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On Fri, 19 Jul 2019 15:12:24 +0200, Ilya Leoshkevich wrote:
&gt;<i> &gt; Am 18.07.2019 um 20:51 schrieb Jakub Kicinski &lt;jakub.kicinski@xxxxxxxxxxxxx&gt;:</i>
&gt;<i> &gt; </i>
&gt;<i> &gt; We should probably make a script with all the ways of calling make</i>
&gt;<i> &gt; should work. Otherwise we can lose track too easily.  </i>
&gt;<i> </i>
&gt;<i> Thanks for the script!</i>
&gt;<i> </i>
&gt;<i> I&#x2019;m trying to make it all pass now, and hitting a weird issue in the</i>
&gt;<i> Kbuild case. The build prints &quot;No rule to make target</i>
&gt;<i> 'scripts/Makefile.ubsan.o'&quot; and proceeds with an empty BPFTOOL_VERSION,</i>
&gt;<i> which causes problems later on.</i>

Does it only break with UBSAN enabled?

&gt;<i> I've found that this is caused by sub_make_done=1 environment variable,</i>
&gt;<i> and unsetting it indeed fixes the problem, since the root Makefile no</i>
&gt;<i> longer uses the implicit %.o rule.</i>
&gt;<i> </i>
&gt;<i> However, I wonder if that would be acceptable in the final version of</i>
&gt;<i> the patch, and whether there is a cleaner way to achieve the same</i>
&gt;<i> effect?</i>

I'm not sure to be honest. Did you check how perf deals with that?

My goal was primarily to make sure we don't regress, so maybe if some
corner cases don't work that's not the end of the world. I think a good
rule of the thumb would be &quot;if it works for perf it should work for
bpftool&quot; ;) Perf gets a lot more build testing.



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="05497" href="msg05497.html">Building bpftool with OUTPUT set breaks</a></strong>
<ul><li><em>From:</em> Lorenz Bauer</li></ul></li>
<li><strong><a name="05499" href="msg05499.html">[PATCH bpf] tools/bpf: fix bpftool build with OUTPUT set</a></strong>
<ul><li><em>From:</em> Ilya Leoshkevich</li></ul></li>
<li><strong><a name="05510" href="msg05510.html">Re: [PATCH bpf] tools/bpf: fix bpftool build with OUTPUT set</a></strong>
<ul><li><em>From:</em> Jakub Kicinski</li></ul></li>
<li><strong><a name="05526" href="msg05526.html">Re: [PATCH bpf] tools/bpf: fix bpftool build with OUTPUT set</a></strong>
<ul><li><em>From:</em> Ilya Leoshkevich</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg05556.html">Re: [PATCH bpf] libbpf: fix missing __WORDSIZE definition</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg05558.html">Re: [PATCH bpf] libbpf: fix missing __WORDSIZE definition</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg05526.html">Re: [PATCH bpf] tools/bpf: fix bpftool build with OUTPUT set</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg05502.html">[PATCH bpf v2] bpf: fix narrower loads on s390</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#05557"><strong>Date</strong></a></li>
<li><a href="index.html#05557"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-samsung-soc/>[Linux&nbsp;Samsung&nbsp;SoC]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-rockchip/>[Linux&nbsp;Rockchip&nbsp;SoC]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-actions/>[Linux&nbsp;Actions&nbsp;SoC]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-snps-arc/>[Linux&nbsp;for&nbsp;Synopsys&nbsp;ARC&nbsp;Processors]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-nfs/>[Linux&nbsp;NFS]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-nilfs/>[Linux&nbsp;NILFS]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-usb/>[Linux&nbsp;USB&nbsp;Devel]</a>
&nbsp;
&nbsp;
<a href=/lists/vfl/>[Video&nbsp;for&nbsp;Linux]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-audio-users/>[Linux&nbsp;Audio&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info/>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kernel/>[Linux&nbsp;Kernel]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-scsi/>[Linux&nbsp;SCSI]</a>
</font>
</center>
<p>
<hr>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
