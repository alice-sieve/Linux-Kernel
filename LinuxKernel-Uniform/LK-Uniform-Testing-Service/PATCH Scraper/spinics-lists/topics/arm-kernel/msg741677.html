<!-- MHonArc v2.6.19 -->
<!--X-Subject: RE: [PATCH v3 1/2] dt&#45;bindings: mailbox: add binding doc for the ARM SMC/HVC mailbox -->
<!--X-From-R13: Brat Tna &#60;crat.snaNakc.pbz> -->
<!--X-Date: Wed, 17 Jul 2019 18:48:10 &#45;0700 -->
<!--X-Message-Id: AM0PR04MB448136F19FBE4674E56A7A4288C80@AM0PR04MB4481.eurprd04.prod.outlook.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1563184103&#45;8493&#45;1&#45;git&#45;send&#45;email&#45;peng.fan@nxp.com -->
<!--X-Reference: 1563184103&#45;8493&#45;2&#45;git&#45;send&#45;email&#45;peng.fan@nxp.com -->
<!--X-Reference: 20190717172801.GG18370@e107155&#45;lin -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<meta name="description" content="Linux ARM, OMAP, Xscale Kernel: RE: [PATCH v3 1/2] dt-bindings: mailbox: add binding doc for the ARM SMC/HVC mailbox">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>RE: [PATCH v3 1/2] dt-bindings: mailbox: add binding doc for the ARM SMC/HVC mailbox &mdash; ARM, OMAP, Xscale Linux Kernel</title>
<link rel="alternate" type="application/rss+xml" title="Linux ARM Kernel" href="//feedproxy.google.com/LinuxArmKernel">
<link rel="alternate" type="application/rss+xml" title="Linux ARM Kernel" href="//feeds.feedburner.com/LinuxArmxscaleEtc">
<link rel="alternate" type="application/rss+xml" title="Fedora ARM" href="//feeds.feedburner.com/FedoraArm">
<link rel="alternate" type="application/rss+xml" title="Linux for OMAP" href="//feedproxy.google.com/LinuxOmap">
</head>
<body itemscope itemtype="//schema.org/Article" vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<td align=right><form action="//www.google.com/cse" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:isdiegq275o" />
    <input type="hidden" name="ie" value="ISO-8859-1" />
    <input type="text" name="q" size="37" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/cse/brand?form=cse-search-box&amp;lang=en" async></script>
<h1 itemprop="name">RE: [PATCH v3 1/2] dt-bindings: mailbox: add binding doc for the ARM SMC/HVC mailbox</h1>
[<a href="msg741676.html">Date Prev</a>][<a href="msg741678.html">Date Next</a>][<a href="msg741626.html">Thread Prev</a>][<a href="msg741076.html">Thread Next</a>][<a href="maillist.html#741677">Date Index</a>][<a href="threads.html#741677">Thread Index</a>] 
<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: RE: [PATCH v3 1/2] dt-bindings: mailbox: add binding doc for the ARM SMC/HVC mailbox</li>
<li><em>From</em>: Peng Fan &lt;peng.fan@xxxxxxx&gt;</li>
<li><em>Date</em>: Thu, 18 Jul 2019 01:47:56 +0000</li>
<li><em>In-reply-to</em>: &lt;20190717172801.GG18370@e107155-lin&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi Sudeep,

&gt;<i> Subject: Re: [PATCH v3 1/2] dt-bindings: mailbox: add binding doc for the ARM</i>
&gt;<i> SMC/HVC mailbox</i>
&gt;<i> </i>
&gt;<i> This looks much better now.</i>
&gt;<i> </i>
&gt;<i> On Mon, Jul 15, 2019 at 10:10:10AM +0000, Peng Fan wrote:</i>
&gt;<i> &gt; From: Peng Fan &lt;peng.fan@xxxxxxx&gt;</i>
&gt;<i> &gt;</i>
&gt;<i> &gt; The ARM SMC/HVC mailbox binding describes a firmware interface to</i>
&gt;<i> &gt; trigger actions in software layers running in the EL2 or EL3 exception levels.</i>
&gt;<i> &gt; The term &quot;ARM&quot; here relates to the SMC instruction as part of the ARM</i>
&gt;<i> &gt; instruction set, not as a standard endorsed by ARM Ltd.</i>
&gt;<i> &gt;</i>
&gt;<i> &gt; Signed-off-by: Peng Fan &lt;peng.fan@xxxxxxx&gt;</i>
&gt;<i> &gt; ---</i>
&gt;<i> &gt;</i>
&gt;<i> &gt; V3:</i>
&gt;<i> &gt;  Convert to yaml</i>
&gt;<i> &gt;  Drop interrupt</i>
&gt;<i> &gt;  Introudce transports to indicate mem/reg  The func id is still kept</i>
&gt;<i> &gt; as optional, because like SCMI it only  cares about message.</i>
&gt;<i> &gt;</i>
&gt;<i> &gt; V2:</i>
&gt;<i> &gt;  Introduce interrupts as a property.</i>
&gt;<i> &gt;</i>
&gt;<i> &gt;  .../devicetree/bindings/mailbox/arm-smc.yaml       | 124</i>
&gt;<i> +++++++++++++++++++++</i>
&gt;<i> &gt;  1 file changed, 124 insertions(+)</i>
&gt;<i> &gt;  create mode 100644</i>
&gt;<i> &gt; Documentation/devicetree/bindings/mailbox/arm-smc.yaml</i>
&gt;<i> &gt;</i>
&gt;<i> &gt; diff --git a/Documentation/devicetree/bindings/mailbox/arm-smc.yaml</i>
&gt;<i> &gt; b/Documentation/devicetree/bindings/mailbox/arm-smc.yaml</i>
&gt;<i> &gt; new file mode 100644</i>
&gt;<i> &gt; index 000000000000..da9b1a03bc4e</i>
&gt;<i> &gt; --- /dev/null</i>
&gt;<i> &gt; +++ b/Documentation/devicetree/bindings/mailbox/arm-smc.yaml</i>
&gt;<i> &gt; @@ -0,0 +1,124 @@</i>
&gt;<i> &gt; +# SPDX-License-Identifier: (GPL-2.0 OR BSD-2-Clause) %YAML 1.2</i>
&gt;<i> &gt; +---</i>
&gt;<i> &gt; +$id:</i>
&gt;<i> &gt; +<a  rel="nofollow" href="https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fdevi">https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fdevi</a></i>
&gt;<i> &gt;</i>
&gt;<i> +cetree.org%2Fschemas%2Fmailbox%2Farm-smc.yaml%23&amp;amp;data=02%7</i>
&gt;<i> C01%7Cp</i>
&gt;<i> &gt;</i>
&gt;<i> +eng.fan%40nxp.com%7Cb5039d50ce8c40928edb08d70adc20f9%7C686ea1</i>
&gt;<i> d3bc2b4c</i>
&gt;<i> &gt;</i>
&gt;<i> +6fa92cd99c5c301635%7C0%7C1%7C636989812923178414&amp;amp;sdata=UT</i>
&gt;<i> 7r2vOLX4a</i>
&gt;<i> &gt; +tv7Yfh750wdSXSh2ZPxeJOXLWl5yACK0%3D&amp;amp;reserved=0</i>
&gt;<i> &gt; +$schema:</i>
&gt;<i> &gt; +<a  rel="nofollow" href="https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fdevi">https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fdevi</a></i>
&gt;<i> &gt;</i>
&gt;<i> +cetree.org%2Fmeta-schemas%2Fcore.yaml%23&amp;amp;data=02%7C01%7Cpe</i>
&gt;<i> ng.fan%</i>
&gt;<i> &gt;</i>
&gt;<i> +40nxp.com%7Cb5039d50ce8c40928edb08d70adc20f9%7C686ea1d3bc2b4c</i>
&gt;<i> 6fa92cd9</i>
&gt;<i> &gt;</i>
&gt;<i> +9c5c301635%7C0%7C1%7C636989812923178414&amp;amp;sdata=3Gjn1NQtO</i>
&gt;<i> PbvfTvyN3X</i>
&gt;<i> &gt; +b89%2BvvGO2ff6DpGQUQejGAzU%3D&amp;amp;reserved=0</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +title: ARM SMC Mailbox Interface</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +maintainers:</i>
&gt;<i> &gt; +  - Peng Fan &lt;peng.fan@xxxxxxx&gt;</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +description: |</i>
&gt;<i> &gt; +  This mailbox uses the ARM smc (secure monitor call) and hvc</i>
&gt;<i> &gt; +(hypervisor</i>
&gt;<i> &gt; +  call) instruction to trigger a mailbox-connected activity in</i>
&gt;<i> &gt; +firmware,</i>
&gt;<i> &gt; +  executing on the very same core as the caller. By nature this</i>
&gt;<i> &gt; +operation</i>
&gt;<i> &gt; +  is synchronous and this mailbox provides no way for asynchronous</i>
&gt;<i> &gt; +messages</i>
&gt;<i> &gt; +  to be delivered the other way round, from firmware to the OS, but</i>
&gt;<i> &gt; +  asynchronous notification could also be supported. However the</i>
&gt;<i> &gt; +value of</i>
&gt;<i> &gt; +  r0/w0/x0 the firmware returns after the smc call is delivered as a</i>
&gt;<i> &gt; +received</i>
&gt;<i> &gt; +  message to the mailbox framework, so a synchronous communication</i>
&gt;<i> &gt; +can be</i>
&gt;<i> &gt; +  established, for a asynchronous notification, no value will be returned.</i>
&gt;<i> &gt; +  The exact meaning of both the action the mailbox triggers as well</i>
&gt;<i> &gt; +as the</i>
&gt;<i> &gt; +  return value is defined by their users and is not subject to this binding.</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +  One use case of this mailbox is the SCMI interface, which uses</i>
&gt;<i> &gt; + shared memory  to transfer commands and parameters, and a mailbox</i>
&gt;<i> to</i>
&gt;<i> &gt; + trigger a function  call. This allows SoCs without a separate</i>
&gt;<i> &gt; + management processor (or when  such a processor is not available or</i>
&gt;<i> &gt; + used) to use this standardized  interface anyway.</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +  This binding describes no hardware, but establishes a firmware</i>
&gt;<i> interface.</i>
&gt;<i> &gt; +  Upon receiving an SMC using one of the described SMC function</i>
&gt;<i> &gt; + identifiers,  the firmware is expected to trigger some mailbox connected</i>
&gt;<i> functionality.</i>
&gt;<i> &gt; +  The communication follows the ARM SMC calling convention.</i>
&gt;<i> &gt; +  Firmware expects an SMC function identifier in r0 or w0. The</i>
&gt;<i> &gt; + supported  identifiers are passed from consumers, or listed in the</i>
&gt;<i> &gt; + the arm,func-ids  properties as described below. The firmware can</i>
&gt;<i> &gt; + return one value in  the first SMC result register, it is expected</i>
&gt;<i> &gt; + to be an error value,  which shall be propagated to the mailbox client.</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +  Any core which supports the SMC or HVC instruction can be used, as</i>
&gt;<i> &gt; + long as  a firmware component running in EL3 or EL2 is handling these</i>
&gt;<i> calls.</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +properties:</i>
&gt;<i> &gt; +  compatible:</i>
&gt;<i> &gt; +    const: arm,smc-mbox</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +  &quot;#mbox-cells&quot;:</i>
&gt;<i> &gt; +    const: 1</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +  arm,num-chans:</i>
&gt;<i> &gt; +    description: The number of channels supported.</i>
&gt;<i> &gt; +    $ref: /schemas/types.yaml#/definitions/uint32</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +  method:</i>
&gt;<i> &gt; +    items:</i>
&gt;<i> &gt; +      - enum:</i>
&gt;<i> &gt; +          - smc</i>
&gt;<i> &gt; +          - hvc</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +  transports:</i>
&gt;<i> &gt; +    items:</i>
&gt;<i> &gt; +      - enum:</i>
&gt;<i> &gt; +          - mem</i>
&gt;<i> &gt; +          - reg</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +  arm,func-ids:</i>
&gt;<i> &gt; +    description: |</i>
&gt;<i> &gt; +      An array of 32-bit values specifying the function IDs used by each</i>
&gt;<i> &gt; +      mailbox channel. Those function IDs follow the ARM SMC calling</i>
&gt;<i> &gt; +      convention standard [1].</i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +      There is one identifier per channel and the number of supported</i>
&gt;<i> &gt; +      channels is determined by the length of this array.</i>
&gt;<i> &gt; +    minItems: 0</i>
&gt;<i> &gt; +    maxItems: 4096   # Should be enough?</i>
&gt;<i> </i>
&gt;<i> I am new to yaml, is there a way to say the number of entries here must</i>
&gt;<i> match arm,num-chans ? And not sure if min/maxItems matter then ?</i>

I am also new to yaml, Rob might have ideas.

&gt;<i> </i>
&gt;<i> &gt; +</i>
&gt;<i> &gt; +required:</i>
&gt;<i> &gt; +  - compatible</i>
&gt;<i> &gt; +  - &quot;#mbox-cells&quot;</i>
&gt;<i> &gt; +  - arm,num-chans</i>
&gt;<i> &gt; +  - transports</i>
&gt;<i> &gt; +  - method</i>
&gt;<i> &gt; +</i>
&gt;<i> </i>
&gt;<i> Why is arm,func-ids optional ? Is there any standard arm,func-ids we can</i>
&gt;<i> resort to. Sorry I know you expect ARM Ltd to answer that, but I just want to</i>
&gt;<i> raise the point that we don't have one today and hence it can't be optional. Or</i>
&gt;<i> I am missing something ?</i>

In the v3 patchset, Jassi expected the id be passed from client firmware driver,
but you said scmi is expected a only message protocol. So here I still keep this
as optional, if specified in dts, the mailbox driver will use it. If not specificed
in dts, the mailbox driver expect the client firmware driver pass the func id to
mailbox driver.

Thanks,
Peng.

&gt;<i> </i>
&gt;<i> --</i>
&gt;<i> Regards,</i>
&gt;<i> Sudeep</i>

_______________________________________________
linux-arm-kernel mailing list
linux-arm-kernel@xxxxxxxxxxxxxxxxxxx
<a  rel="nofollow" href="http://lists.infradead.org/mailman/listinfo/linux-arm-kernel">http://lists.infradead.org/mailman/listinfo/linux-arm-kernel</a>


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="741074" href="msg741074.html">[PATCH v3 0/2] mailbox: arm: introduce smc triggered mailbox</a></strong>
<ul><li><em>From:</em> Peng Fan</li></ul></li>
<li><strong><a name="741075" href="msg741075.html">[PATCH v3 1/2] dt-bindings: mailbox: add binding doc for the ARM SMC/HVC mailbox</a></strong>
<ul><li><em>From:</em> Peng Fan</li></ul></li>
<li><strong><a name="741626" href="msg741626.html">Re: [PATCH v3 1/2] dt-bindings: mailbox: add binding doc for the ARM SMC/HVC mailbox</a></strong>
<ul><li><em>From:</em> Sudeep Holla</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg741676.html">RE: [PATCH v3 1/2] dt-bindings: mailbox: add binding doc for the ARM SMC/HVC mailbox</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg741678.html">Re: [PATCH 2/3 v4] dt-bindings: gpio: aspeed: Add SGPIO support</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg741626.html">Re: [PATCH v3 1/2] dt-bindings: mailbox: add binding doc for the ARM SMC/HVC mailbox</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg741076.html">[PATCH v3 2/2] mailbox: introduce ARM SMC based mailbox</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#741677"><strong>Date</strong></a></li>
<li><a href="threads.html#741677"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/lists/kernel/>[Linux&nbsp;Kernel]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-arm/>[Linux&nbsp;ARM&nbsp;(vger)]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-arm-msm/>[Linux&nbsp;ARM&nbsp;MSM]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-omap/>[Linux&nbsp;Omap]</a>
&nbsp;
&nbsp;
<a href=/lists/centos-arm-devel/>[CentOS&nbsp;ARM]</a>
&nbsp;
&nbsp;
<a href=/lists/arm/>[Linux&nbsp;Arm]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-tegra/>[Linux&nbsp;Tegra]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-arm/>[Fedora&nbsp;ARM]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-samsung-soc/>[Linux&nbsp;for&nbsp;Samsung&nbsp;SOC]</a>
&nbsp;
&nbsp;
<a href=/lists/ecos/>[eCos]</a>
&nbsp;
&nbsp;
<a href=/lists/fastboot/>[Linux&nbsp;Fastboot]</a>
&nbsp;
&nbsp;
<a href=/lists/gcchelp/>[Gcc&nbsp;Help]</a>
&nbsp;
&nbsp;
<a href=/lists/git/>[Git]</a>
&nbsp;
&nbsp;
<a href=/lists/dccp/>[DCCP]</a>
&nbsp;
&nbsp;
<a href=/lists/ietf-ann>[IETF&nbsp;Announce]</a>
&nbsp;
&nbsp;
<a href=/lists/security/>[Security]</a>
&nbsp;
&nbsp;
<a href=/lists/mips/>[Linux&nbsp;MIPS]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }

initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
