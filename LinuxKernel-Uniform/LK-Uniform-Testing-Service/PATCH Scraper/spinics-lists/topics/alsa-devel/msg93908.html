<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re:  [PATCH V6 RESEND] ALSA: usb&#45;audio: Scarlett Gen 2	mixer interface -->
<!--X-From-R13: Fnxnfuv Wjnv &#60;gvjnvNfhfr.qr> -->
<!--X-Date: Thu, 18 Jul 2019 08:54:15 &#45;0700 -->
<!--X-Message-Id: s5hd0i7nxue.wl&#45;tiwai@suse.de -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20190717155105.GA4198@b4.vu -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Re:  [PATCH V6 RESEND] ALSA: usb-audio: Scarlett Gen 2	mixer interface &mdash; ALSA Devel">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Re:  [PATCH V6 RESEND] ALSA: usb-audio: Scarlett Gen 2	mixer interface &mdash; ALSA Devel</title>
<link rel="alternate" type="application/rss+xml" title="ALSA Devel" href="//feedproxy.google.com/AlsaDevel">
</head>
<body itemscope itemtype="//schema.org/Article" vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">Re:  [PATCH V6 RESEND] ALSA: usb-audio: Scarlett Gen 2	mixer interface</h1>
[<a href="msg93907.html">Date Prev</a>][<a href="msg93909.html">Date Next</a>][<a href="msg93861.html">Thread Prev</a>][<a href="msg93939.html">Thread Next</a>][<a href="maillist.html#93908">Date Index</a>][<a href="threads.html#93908">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: &quot;Geoffrey D. Bennett&quot; &lt;g@xxxxx&gt;</li>
<li><em>Subject</em>: Re:  [PATCH V6 RESEND] ALSA: usb-audio: Scarlett Gen 2	mixer interface</li>
<li><em>From</em>: Takashi Iwai &lt;tiwai@xxxxxxx&gt;</li>
<li><em>Date</em>: Thu, 18 Jul 2019 17:53:13 +0200</li>
<li><em>Cc</em>: alsa-devel@xxxxxxxxxxxxxxxx</li>
<li><em>In-reply-to</em>: &lt;<a href="msg93861.html">20190717155105.GA4198@b4.vu</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg93861.html">20190717155105.GA4198@b4.vu</a>&gt;</li>
<li><em>User-agent</em>: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka) FLIM/1.14.9 (Goj&#x14D;) APEL/10.8 Emacs/25.3 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On Wed, 17 Jul 2019 17:51:05 +0200,
Geoffrey D. Bennett wrote:
&gt; 
&gt; Add mixer quirk for the Focusrite Scarlett 6i6, 18i8, and 18i20 Gen 2
&gt; audio interfaces. Although the interfaces are USB compliant,
&gt; additional input/output level controls and hardware routing/mixing
&gt; functionality are available using proprietary USB requests.
&gt; 
&gt; Signed-off-by: Geoffrey D. Bennett &lt;g@xxxxx&gt;
&gt; ---
&gt; Hi all,
&gt; 
&gt; This patch adds the following controls for the Scarlett 6i6, 18i8, and
&gt; 18i20 Gen 2:
&gt; - Master volume knob indicator (18i20 only)
&gt; - Mute and dim switches (18i20 only)
&gt; - Volume controls for the analogue HW outputs
&gt; - HW/SW volume switches for the 10 analogue HW outputs (18i20 only)
&gt; - Line Level/Instrument Level and Pad controls (6i6 and 18i8 only)
&gt; - Output mux (where the sound for the HW outputs comes from; defaults
&gt;   to PCM outputs)
&gt; - Capture mux (where the sound for PCM recording comes from; defaults
&gt;   to HW inputs)
&gt; - Matrix mux (where the sound going into the mixer comes from; 18
&gt;   inputs default off)
&gt; - Mixer matrix (18 inputs * 10 outputs = 180 controls)
&gt; - Level meters
&gt; 
&gt; Changes since v1:
&gt; - Add support for the Scarlett 18i8 Gen 2
&gt; - Save configuration parameters to NVRAM
&gt; - Implemented feedback from Takashi's email 24/Apr/2019
&gt; - Moved private field from struct snd_usb_audio to struct
&gt;   usb_mixer_interface
&gt; - Added timer and buffer fields to struct usb_mixer_interface
&gt; - Other small code fixes/cleanups/improvements
&gt; 
&gt; Changes since v2:
&gt; - Add support for the Scarlett 6i6 Gen 2
&gt; - Add support for controlling the mute/dim switches (18i20 only)
&gt; - Implemented feedback from Takashi's email 29/Apr/2019: One pointer
&gt;   field private_data and one function pointer private_free. Replaced
&gt;   timer with delayed work (thanks for that suggestion; it makes the
&gt;   code a *lot* simpler!).
&gt; - The new functionality is disabled by default as there were reports
&gt;   of some Gen 2 devices not responding to the initialisation sequence
&gt;   and hanging. Added module parameter &quot;scarlett_gen2_mixer_enable&quot;.
&gt;   If this parameter is not set, logs a message &quot;Focusrite Scarlett Gen
&gt;   2 Mixer Driver disabled; use options snd_usb_audio
&gt;   scarlett_gen2_mixer_enable=1 to enable and report any issues to
&gt;   g@xxxxx&quot;.
&gt; 
&gt; Changes since v3:
&gt; - No functional changes; fix checkpatch.pl error and typo in
&gt;   declaration.
&gt; 
&gt; Changes since v4:
&gt; - Implemented feedback from Takashi's email 9/Jul/2019: cancel
&gt;   delayed work on suspend, drop copyright texts, remove unnecessary
&gt;   blank lines, and run kmalloc outside the mutex.
&gt; 
&gt; Changes since v5:
&gt; - Implemented feedback from Takashi's emails 9-10/Jul/2019: use
&gt;   chip-&gt;setup value (device_setup option) instead of the
&gt;   scarlett_gen2_mixer_enable option and sync config to NVRAM
&gt;   immediately on suspend.
&gt; - Fixed issue where the config save delayed work would be cancelled
&gt;   and not restarted if a scarlett2_*_ctl_put() function was called and
&gt;   the parameter value was not changed.
&gt; - Renaming definitions and functions for consistency and move private
&gt;   free/suspend functions above their use so pre-declaration isn't
&gt;   necessary.

Thanks, the patch looks almost good, but it's already too late for
5.3, so I'm going to queue this for 5.4 after 5.3 merge window is
closed in this week.

But, before that, maybe one more refresh would be appreciated.
Namely,

- We need a verification of the fixed pipe before actually submitting
  urb.  scarlett2_usb() calls with usb_sndctrlpipe(), and this pipe
  has to be verified beforehand.  See the commit 801ebf1043ae for
  details.

- Some pointers seem to be initialized as &quot;0&quot;.  Use NULL instead.


Takashi
_______________________________________________
Alsa-devel mailing list
Alsa-devel@xxxxxxxxxxxxxxxx
<a  rel="nofollow" href="https://mailman.alsa-project.org/mailman/listinfo/alsa-devel">https://mailman.alsa-project.org/mailman/listinfo/alsa-devel</a>


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="93939" href="msg93939.html">Re:  [PATCH V6 RESEND] ALSA: usb-audio: Scarlett Gen 2	mixer interface</a></strong>
<ul><li><em>From:</em> Geoffrey D. Bennett</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="93861" href="msg93861.html">[PATCH V6 RESEND] ALSA: usb-audio: Scarlett Gen 2	mixer interface</a></strong>
<ul><li><em>From:</em> Geoffrey D. Bennett</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg93907.html">Re:  [PATCH v3 1/2] ASoC: SOF: add flag for position	update ipc</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg93909.html">Re:  [PATCH v5 2/6] ASoC: sgtl5000: Improve VAG power	and mute control</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg93861.html">[PATCH V6 RESEND] ALSA: usb-audio: Scarlett Gen 2	mixer interface</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg93939.html">Re:  [PATCH V6 RESEND] ALSA: usb-audio: Scarlett Gen 2	mixer interface</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#93908"><strong>Date</strong></a></li>
<li><a href="threads.html#93908"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/alsa-user/>[ALSA&nbsp;User]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-audio-users/>[Linux&nbsp;Audio&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/pulse-audio/>[Pulse&nbsp;Audio]</a>
&nbsp;
&nbsp;
<a href=/lists/kernel/>[Kernel&nbsp;Archive]</a>
&nbsp;
&nbsp;
<a href=/lists/asterisk/>[Asterisk&nbsp;PBX]</a>
&nbsp;
&nbsp;
<a href=http://yosemitephotos.net/>[Photo&nbsp;Sharing]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/linux-sound/>[Linux&nbsp;Sound]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-media/>[Video&nbsp;4&nbsp;Linux]</a>
&nbsp;
&nbsp;
<a href=/lists/gimp/>[Gimp]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
