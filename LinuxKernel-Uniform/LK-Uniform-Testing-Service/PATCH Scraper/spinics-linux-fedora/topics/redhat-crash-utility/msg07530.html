<!-- MHonArc v2.6.19 -->
<!--X-Subject: [PATCH 6/6] Add a '&#45;B' flag to the list command to	call the brent algorithm. -->
<!--X-From-R13: Rnir Ilfbpunafxv &#60;qjlfbpunNerqung.pbz> -->
<!--X-Date: Tue, 10 Jul 2018 15:24:54 &#45;0700 -->
<!--X-Message-Id: 1531261479&#45;23412&#45;7&#45;git&#45;send&#45;email&#45;dwysocha@redhat.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1531261479&#45;23412&#45;1&#45;git&#45;send&#45;email&#45;dwysocha@redhat.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="[PATCH 6/6] Add a '-B' flag to the list command to	call the brent algorithm. &mdash; Red Hat Crash Utility">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Red Hat Crash Utility &mdash;  [PATCH 6/6] Add a '-B' flag to the list command to	call the brent algorithm.</title>
<link rel="alternate" type="application/rss+xml" title="Red Hat Crash Utility" href="//feeds.feedburner.com/RedHatCrashUtility">
</head>
<body itemscope itemtype="//schema.org/Article" vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">[PATCH 6/6] Add a '-B' flag to the list command to	call the brent algorithm.</h1>
[<a href="msg07528.html">Date Prev</a>][<a href="msg07532.html">Date Next</a>][<a href="msg07528.html">Thread Prev</a>][<a href="msg07535.html">Thread Next</a>][<a href="maillist.html#07530">Date Index</a>][<a href="index.html#07530">Thread Index</a>]
<script src="https://apis.google.com/js/platform.js" async defer></script>
<g:plusone size="small"></g:plusone>
<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: [PATCH 6/6] Add a '-B' flag to the list command to	call the brent algorithm.</li>
<li><em>From</em>: Dave Wysochanski &lt;dwysocha@xxxxxxxxxx&gt;</li>
<li><em>Date</em>: Tue, 10 Jul 2018 18:24:39 -0400</li>
<li><em>In-reply-to</em>: &lt;<a href="msg07525.html">1531261479-23412-1-git-send-email-dwysocha@redhat.com</a>&gt;</li>
<li><em>Reply-to</em>: &quot;Discussion list for crash utility usage,	maintenance and development&quot; &lt;crash-utility@xxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" defer async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>The do_list_no_hash function does not use a hash table or allocate
much memory to enumerate lists, and thus it is much faster.
The new function implements Brent's algorithm for cycle detection,
so in addition to being faster it adds a couple additional loop
statistics to the output.  Add a new '-B' option to the list command
allows use of this new algorithm while still retaining the default
behavior of the 'list' command.

Signed-off-by: Dave Wysochanski &lt;dwysocha@xxxxxxxxxx&gt;
---
 defs.h  |  1 +
 help.c  |  6 ++++++
 tools.c | 15 +++++++++++----
 3 files changed, 18 insertions(+), 4 deletions(-)

diff --git a/defs.h b/defs.h
index 3ab295a..5af82be 100644
--- a/defs.h
+++ b/defs.h
@@ -2491,6 +2491,7 @@ struct list_data {             /* generic structure used by do_list() to walk */
 #define CALLBACK_RETURN     (VERBOSE &lt;&lt; 12)
 #define LIST_PARSE_MEMBER   (VERBOSE &lt;&lt; 13)
 #define LIST_READ_MEMBER    (VERBOSE &lt;&lt; 14)
+#define LIST_BRENT_ALGO     (VERBOSE &lt;&lt; 15)
 
 struct tree_data {
 	ulong flags;
diff --git a/help.c b/help.c
index 638c6ec..a1c4c63 100644
--- a/help.c
+++ b/help.c
@@ -5822,6 +5822,12 @@ char *help__list[] = {
 &quot;           -r  For a list linked with list_head structures, traverse the list&quot;,
 &quot;               in the reverse order by using the \&quot;prev\&quot; pointer instead&quot;,
 &quot;               of \&quot;next\&quot;.&quot;,
+&quot;           -B  Use the algorithm from R. P. Brent to detect loops instead of&quot;,
+&quot;               using a hash table.  This algorithm uses a tiny fixed amount of&quot;,
+&quot;               memory and so is especially helpful for longer lists.  The output&quot;,
+&quot;               is slightly different than the normal list output as it will&quot;,
+&quot;               print the length of the loop, the start of the loop, and the&quot;,
+&quot;               first duplicate in the list.&quot;,
 &quot; &quot;,
 &quot;  The meaning of the \&quot;start\&quot; argument, which can be expressed symbolically,&quot;,
 &quot;  in hexadecimal format, or an expression evaluating to an address, depends&quot;,
diff --git a/tools.c b/tools.c
index ba525a8..eeba4c4 100644
--- a/tools.c
+++ b/tools.c
@@ -3266,9 +3266,12 @@ cmd_list(void)
 	BZERO(ld, sizeof(struct list_data));
 	struct_list_offset = 0;
 
-	while ((c = getopt(argcnt, args, &quot;Hhrs:S:e:o:xdl:&quot;)) != EOF) {
+	while ((c = getopt(argcnt, args, &quot;BHhrs:S:e:o:xdl:&quot;)) != EOF) {
                 switch(c)
 		{
+		case 'B':
+			ld-&gt;flags |= LIST_BRENT_ALGO;
+			break;
 		case 'H':
 			ld-&gt;flags |= LIST_HEAD_FORMAT;
 			ld-&gt;flags |= LIST_HEAD_POINTER;
@@ -3516,9 +3519,13 @@ next_arg:
 	ld-&gt;flags &amp;= ~(LIST_OFFSET_ENTERED|LIST_START_ENTERED);
 	ld-&gt;flags |= VERBOSE;
 
-	hq_open();
-	c = do_list(ld);
-	hq_close();
+	if (ld-&gt;flags &amp; LIST_BRENT_ALGO)
+		c = do_list_no_hash(ld);
+	else {
+		hq_open();
+		c = do_list(ld);
+		hq_close();
+	}
 
         if (ld-&gt;structname_args)
 		FREEBUF(ld-&gt;structname);
-- 
1.8.3.1

--
Crash-utility mailing list
Crash-utility@xxxxxxxxxx
<a  rel="nofollow" href="https://www.redhat.com/mailman/listinfo/crash-utility">https://www.redhat.com/mailman/listinfo/crash-utility</a>


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="07525" href="msg07525.html">[PATCH 0/5] Add Brent algorithm as an option for	the 'list' command</a></strong>
<ul><li><em>From:</em> Dave Wysochanski</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg07528.html">[PATCH 5/6] Implement R. P. Brent's algorithm for	loop detection for 'list' command.</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg07532.html">Re:  [PATCH v2] x86_64: Make the conversion between 4level and 5level paging automatically</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg07528.html">[PATCH 5/6] Implement R. P. Brent's algorithm for	loop detection for 'list' command.</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg07535.html">Re:  [PATCH 0/5] Add Brent algorithm as an option for the 'list' command</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#07530"><strong>Date</strong></a></li>
<li><a href="index.html#07530"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-devel/>[Fedora&nbsp;Development]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-tools/>[Fedora&nbsp;Tools]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width="100%">
<tr>
<td align=left>&nbsp;</td>
<td valign=top align=right><H1><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></H1></td>
</tr></table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
