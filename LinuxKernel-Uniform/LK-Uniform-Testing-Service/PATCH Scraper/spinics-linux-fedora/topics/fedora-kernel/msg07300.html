<!-- MHonArc v2.6.19 -->
<!--X-Subject: [PATCH] mmc: dw_mmc&#45;k3: Add clk and reset softdep -->
<!--X-From-R13: Xrerzl Zvagba &#60;wrerzl.yvagbaNnez.pbz> -->
<!--X-Date: Tue, 16 Oct 2018 02:48:51 &#45;0700 -->
<!--X-Message-Id: 20181015171516.3832893&#45;1&#45;jeremy.linton@arm.com -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description content="[PATCH] mmc: dw_mmc-k3: Add clk and reset softdep &mdash; Fedora Linux Kernel">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>[PATCH] mmc: dw_mmc-k3: Add clk and reset softdep &mdash; Fedora Linux Kernel</title>
<link rel="alternate" type="application/rss+xml" title="Fedora Linux Kernel" href="//feeds.feedburner.com/FedoraKernel">
</head>
<body itemscope itemtype="//schema.org/Article" vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en" async defer></script>
<h1 itemprop="name">[PATCH] mmc: dw_mmc-k3: Add clk and reset softdep</h1>
[<a href="msg07299.html">Date Prev</a>][<a href="msg07301.html">Date Next</a>][<a href="msg07292.html">Thread Prev</a>][<a href="msg07301.html">Thread Next</a>][<a href="maillist.html#07300">Date Index</a>][<a href="index.html#07300">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: [PATCH] mmc: dw_mmc-k3: Add clk and reset softdep</li>
<li><em>From</em>: Jeremy Linton &lt;jeremy.linton@xxxxxxx&gt;</li>
<li><em>Date</em>: Mon, 15 Oct 2018 12:15:16 -0500</li>
<li><em>Cc</em>: Jeremy Linton &lt;lintonrjeremy@xxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>From: Jeremy Linton &lt;lintonrjeremy@xxxxxxxxx&gt;

The mmc/k3 driver is dependent on a number of other linux modules
which must be built into the initrd in order to use the mmc/sd
as a boot device for initrd/module based distros.

Normally this would be taken care of with linux's modules.deps
based on symbolic dependencies but the dwmmc drivers have
particularly complex relationships that are based on soft
callback APIs. The result is that dracut and other initrd builders
are unable to determine the module dependencies directly.

To solve this problem linux has MODULE_SOFTDEP() so lets softdep
the hisi clock and reset drivers associated with the k3 implementation.

Signed-off-by: Jeremy Linton &lt;lintonrjeremy@xxxxxxxxx&gt;
---
 drivers/mmc/host/dw_mmc-k3.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/mmc/host/dw_mmc-k3.c b/drivers/mmc/host/dw_mmc-k3.c
index 89cdb3d533bb..cd8f545fa30d 100644
--- a/drivers/mmc/host/dw_mmc-k3.c
+++ b/drivers/mmc/host/dw_mmc-k3.c
@@ -487,3 +487,4 @@ module_platform_driver(dw_mci_k3_pltfm_driver);
 MODULE_DESCRIPTION(&quot;K3 Specific DW-MSHC Driver Extension&quot;);
 MODULE_LICENSE(&quot;GPL v2&quot;);
 MODULE_ALIAS(&quot;platform:dwmmc_k3&quot;);
+MODULE_SOFTDEP(&quot;pre: hi6220_reset clk_hi655x&quot;);
-- 
2.13.6
_______________________________________________
kernel mailing list -- kernel@xxxxxxxxxxxxxxxxxxxxxxx
To unsubscribe send an email to kernel-leave@xxxxxxxxxxxxxxxxxxxxxxx
Fedora Code of Conduct: <a  rel="nofollow" href="https://getfedora.org/code-of-conduct.html">https://getfedora.org/code-of-conduct.html</a>
List Guidelines: <a  rel="nofollow" href="https://fedoraproject.org/wiki/Mailing_list_guidelines">https://fedoraproject.org/wiki/Mailing_list_guidelines</a>
List Archives: <a  rel="nofollow" href="https://lists.fedoraproject.org/archives/list/kernel@xxxxxxxxxxxxxxxxxxxxxxx">https://lists.fedoraproject.org/archives/list/kernel@xxxxxxxxxxxxxxxxxxxxxxx</a>



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg07299.html">Re: [PATCH 1/2] Disable kernel-headers only in Fedora</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg07301.html">[PATCH 0/2] Important i915 eDP fixes for F28/29</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg07292.html">F28 kernels should not have CONFIG_FRAMEBUFFER_CONSOLE_DEFERRED_TAKEOVER set</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg07301.html">[PATCH 0/2] Important i915 eDP fixes for F28/29</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#07300"><strong>Date</strong></a></li>
<li><a href="index.html#07300"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-users/>[Fedora&nbsp;General&nbsp;Discussion]</a>
&nbsp;
&nbsp;
<a href=http://lists.linuxcoding.com/rhl/>[Older&nbsp;Fedora&nbsp;Users&nbsp;Archive]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-advisory-board/>[Fedora&nbsp;Advisory&nbsp;Board]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-security/>[Fedora&nbsp;Security]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-devel-java/>[Fedora&nbsp;Devel&nbsp;Java]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-legacy/>[Fedora&nbsp;Legacy]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/ataraid/>[ATA&nbsp;RAID]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-marketing/>[Fedora&nbsp;Marketing]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-mentors/>[Fedora&nbsp;Mentors]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-package-announce/>[Fedora&nbsp;Package&nbsp;Announce]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-package-review/>[Fedora&nbsp;Package&nbsp;Review]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-music/>[Fedora&nbsp;Music]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-packaging/>[Fedora&nbsp;Packaging]</a>
&nbsp;
&nbsp;
<a href=/lists/centos/>[Centos]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/coolkey/>[Coolkey]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/yum/>[Yum&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/tux/>[Tux]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-art/>[Fedora&nbsp;Art]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-docs/>[Fedora&nbsp;Docs]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-usb/>[USB]</a>
&nbsp;
&nbsp;
<a href=/lists/asterisk/>[Asterisk&nbsp;PBX]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
