<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re: [RFC PATCH v3 04/12] x86/sgx: Require userspace to define enclave pages' protection bits -->
<!--X-From-R13: Oaql Zhgbzvefxv &#60;yhgbNxreary.bet> -->
<!--X-Date: Mon, 15 Jul 2019 15:29:37 &#45;0700 -->
<!--X-Message-Id: CALCETrXMAwHod_KZYPGWjTjg&#45;fxOb1=02=Qj2g1o624wOPfPZQ@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20190617222438.2080&#45;1&#45;sean.j.christopherson@intel.com -->
<!--X-Reference: 20190617222438.2080&#45;5&#45;sean.j.christopherson@intel.com -->
<!--X-Reference: dc3d59c2783ea81d85d4d447bd1a4a2d5fe51421.camel@linux.intel.com -->
<!--X-Reference: 20190619152018.GC1203@linux.intel.com -->
<!--X-Reference: 20190620221702.GE20474@linux.intel.com -->
<!--X-Reference: 20190707190809.GE19593@linux.intel.com -->
<!--X-Reference: 1b7369a08e98dd08a4f8bb19b16479f12bee130f.camel@linux.intel.com -->
<!--X-Reference: 20190708161932.GE20433@linux.intel.com -->
<!--X-Reference: 20190709160634.3yupyabf5svnj4ds@linux.intel.com -->
<!--X-Reference: 20190710172553.GE4348@linux.intel.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Linux Security Module, Re: [RFC PATCH v3 04/12] x86/sgx: Require userspace to define enclave pages' protection bits">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Linux Security Module -- Re: [RFC PATCH v3 04/12] x86/sgx: Require userspace to define enclave pages' protection bits</title>
<link rel="alternate" type="application/rss+xml" title="Linux Security Module" href="//feeds.feedburner.com/LinuxSecurityModule">
</head>
<body vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">Re: [RFC PATCH v3 04/12] x86/sgx: Require userspace to define enclave pages' protection bits</h1>
[<a href="msg29946.html">Date Prev</a>][<a href="msg29948.html">Date Next</a>][<a href="msg29916.html">Thread Prev</a>][<a href="msg29973.html">Thread Next</a>][<a href="maillist.html#29947">Date Index</a>][<a href="index.html#29947">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: Re: [RFC PATCH v3 04/12] x86/sgx: Require userspace to define enclave pages' protection bits</li>
<li><em>From</em>: Andy Lutomirski &lt;luto@xxxxxxxxxx&gt;</li>
<li><em>Date</em>: Mon, 15 Jul 2019 15:29:23 -0700</li>
<li><em>Cc</em>: Jarkko Sakkinen &lt;jarkko.sakkinen@xxxxxxxxxxxxxxx&gt;,        linux-sgx@xxxxxxxxxxxxxxx, Dave Hansen &lt;dave.hansen@xxxxxxxxx&gt;,        Cedric Xing &lt;cedric.xing@xxxxxxxxx&gt;, Andy Lutomirski &lt;luto@xxxxxxxxxx&gt;,        Jethro Beekman &lt;jethro@xxxxxxxxxxxx&gt;,        &quot;Dr . Greg Wettstein&quot; &lt;greg@xxxxxxxxxxxx&gt;,        Stephen Smalley &lt;sds@xxxxxxxxxxxxx&gt;,        LSM List &lt;linux-security-module@xxxxxxxxxxxxxxx&gt;</li>
<li><em>In-reply-to</em>: &lt;20190710172553.GE4348@linux.intel.com&gt;</li>
<li><em>References</em>: &lt;20190617222438.2080-1-sean.j.christopherson@intel.com&gt; &lt;20190617222438.2080-5-sean.j.christopherson@intel.com&gt; &lt;dc3d59c2783ea81d85d4d447bd1a4a2d5fe51421.camel@linux.intel.com&gt; &lt;20190619152018.GC1203@linux.intel.com&gt; &lt;20190620221702.GE20474@linux.intel.com&gt; &lt;20190707190809.GE19593@linux.intel.com&gt; &lt;1b7369a08e98dd08a4f8bb19b16479f12bee130f.camel@linux.intel.com&gt; &lt;20190708161932.GE20433@linux.intel.com&gt; &lt;20190709160634.3yupyabf5svnj4ds@linux.intel.com&gt; &lt;20190710172553.GE4348@linux.intel.com&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On Wed, Jul 10, 2019 at 10:25 AM Sean Christopherson
&lt;sean.j.christopherson@xxxxxxxxx&gt; wrote:
&gt;
&gt; On Tue, Jul 09, 2019 at 07:06:34PM +0300, Jarkko Sakkinen wrote:
&gt; &gt; On Mon, Jul 08, 2019 at 09:19:32AM -0700, Sean Christopherson wrote:
&gt; &gt; &gt; &gt; 2. Probably some &quot;user story&quot; type of examples would help with the
&gt; &gt; &gt; &gt; discussion overall [1] i.e. how one would use this for
&gt; &gt; &gt; &gt; her own good.
&gt; &gt; &gt;
&gt; &gt; &gt; The compelling story is Andy's original concern that userspace could
&gt; &gt; &gt; circumvent existing security policies by running code in an enclave.
&gt; &gt; &gt;
&gt; &gt; &gt; AIUI, closing the LSM loophole is the minimal requirement to get SGX
&gt; &gt; &gt; upstreamed.  The extensive discussion has largely been focused on
&gt; &gt; &gt; ensuring that whatever mechanism is used to close the loophole will
&gt; &gt; &gt; play nice with future SGX functionality and/or LSM security policies.
&gt; &gt;
&gt; &gt; OK, might be getting here where I fall out of the wagon so:
&gt; &gt;
&gt; &gt; Doesn't Andy's example anyway require a process that has privileges to
&gt; &gt; make pages executable i.e. it could run arbitrary code even without an
&gt; &gt; enclave?
&gt;
&gt; Ah, no.  He did raise that concern, but it'd only be an issue if the
&gt; enclave fd were backed by an anon inode, in which case all enclaves would
&gt; need EXECMEM in order to gain PROT_EXEC on EPC.  Because the fd is backed
&gt; /dev/sgx/enclave, userspace just needs FILE__EXECUTE on /dev/sgx/enclave.

I would say it differently: regardless of exactly how /dev/sgx/enclave
is wired up under the hood, we want a way that a process can be
granted permission to usefully run enclaves without being granted
permission to execute whatever bytes of code it wants.  Preferably
without requiring LSMs to maintain some form of enclave signature
whitelist.

This is pretty much the only hard requirement I see.  We really could
achieve this, in a somewhat limited form, by saying that LSMs can
approve or reject the SIGSTRUCT.  But doing it that way is a bit nasty
as we've noticed, for a few reasons.  Several of you have raised
objections to requiring SIGSTRUCT to come from a .sigstruct file.  We
also need to worry about a SIGSTRUCT that refers to an enclave that
forgot to measure its text.  And we need to worry about SGX2.

So this whole messy exercise boils down to: a bunch of security policy
authors think that EXECMEM and similar are not to be given out
lightly.  How to we allow policies like that to be compatible with
SGX?


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg29946.html">Re: [RFC PATCH v2 1/3] x86/sgx: Add SGX specific LSM hooks</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg29948.html">Re: [PATCH V35 23/29] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg29916.html">[PATCH V35 00/29] Kernel lockdown functionality</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg29973.html">[RFC] acpi: Ignore acpi_rsdp kernel param when the kernel has been locked down</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#29947"><strong>Date</strong></a></li>
<li><a href="index.html#29947"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-users/>[Fedora&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
