<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re: [RFC PATCH] security, capability: pass object information to security_capable -->
<!--X-From-R13: Dvpuneq Uhl Pevttf &#60;etoNerqung.pbz> -->
<!--X-Date: Mon, 15 Jul 2019 11:42:22 &#45;0700 -->
<!--X-Message-Id: 20190715184209.j75kpav4tmmunejh@madcap2.tricolour.ca -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20190712173404.14417&#45;1&#45;nhfran2@tycho.nsa.gov -->
<!--X-Reference: alpine.LRH.2.21.1907130347010.1509@namei.org -->
<!--X-Reference: 3605eb1a&#45;fb1c&#45;8933&#45;b1e1&#45;a60e54fb1e1c@tycho.nsa.gov -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Linux Security Module, Re: [RFC PATCH] security, capability: pass object information to security_capable">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Linux Security Module -- Re: [RFC PATCH] security, capability: pass object information to security_capable</title>
<link rel="alternate" type="application/rss+xml" title="Linux Security Module" href="//feeds.feedburner.com/LinuxSecurityModule">
</head>
<body vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">Re: [RFC PATCH] security, capability: pass object information to security_capable</h1>
[<a href="msg29913.html">Date Prev</a>][<a href="msg29915.html">Date Next</a>][<a href="msg29894.html">Thread Prev</a>][<a href="msg29893.html">Thread Next</a>][<a href="maillist.html#29914">Date Index</a>][<a href="index.html#29914">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: Re: [RFC PATCH] security, capability: pass object information to security_capable</li>
<li><em>From</em>: Richard Guy Briggs &lt;rgb@xxxxxxxxxx&gt;</li>
<li><em>Date</em>: Mon, 15 Jul 2019 14:42:09 -0400</li>
<li><em>Cc</em>: James Morris &lt;jmorris@xxxxxxxxx&gt;,        Nicholas Franck &lt;nhfran2@xxxxxxxxxxxxx&gt;, mortonm@xxxxxxxxxxxx,        john.johansen@xxxxxxxxxxxxx, selinux@xxxxxxxxxxxxxxx,        luto@xxxxxxxxxxxxxx, linux-security-module@xxxxxxxxxxxxxxx,        &quot;linux-audit@xxxxxxxxxx&quot; &lt;linux-audit@xxxxxxxxxx&gt;, serge@xxxxxxxxxx</li>
<li><em>In-reply-to</em>: &lt;<a href="msg29894.html">3605eb1a-fb1c-8933-b1e1-a60e54fb1e1c@tycho.nsa.gov</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg29891.html">20190712173404.14417-1-nhfran2@tycho.nsa.gov</a>&gt; &lt;<a href="msg29892.html">alpine.LRH.2.21.1907130347010.1509@namei.org</a>&gt; &lt;<a href="msg29894.html">3605eb1a-fb1c-8933-b1e1-a60e54fb1e1c@tycho.nsa.gov</a>&gt;</li>
<li><em>User-agent</em>: NeoMutt/20180716</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On 2019-07-12 14:02, Stephen Smalley wrote:
&gt; On 7/12/19 1:50 PM, James Morris wrote:
&gt; &gt; On Fri, 12 Jul 2019, Nicholas Franck wrote:
&gt; &gt; 

This aggressive trimming dropped a bit of helpful context:

+++ b/security/lsm_audit.c
@@ -229,9 +229,26 @@ static void dump_common_audit_data(struct
audit_buffer *ab,
        case LSM_AUDIT_DATA_IPC:
                audit_log_format(ab, &quot; key=%d &quot;, a-&gt;u.ipc_id);
                break;
-       case LSM_AUDIT_DATA_CAP:
-               audit_log_format(ab, &quot; capability=%d &quot;, a-&gt;u.cap);

&gt; &gt; &gt; +	case LSM_AUDIT_DATA_CAP: {
&gt; &gt; &gt; +		const struct inode *inode;
&gt; &gt; &gt; +
&gt; &gt; &gt; +		if (a-&gt;u.cap_struct.cad) {
&gt; &gt; &gt; +			switch (a-&gt;u.cap_struct.cad-&gt;type) {
&gt; &gt; &gt; +			case CAP_AUX_DATA_INODE: {
&gt; &gt; &gt; +				inode = a-&gt;u.cap_struct.cad-&gt;u.inode;
&gt; &gt; &gt; +
&gt; &gt; &gt; +				audit_log_format(ab, &quot; dev=&quot;);
&gt; &gt; &gt; +				audit_log_untrustedstring(ab,
&gt; &gt; &gt; +					inode-&gt;i_sb-&gt;s_id);
&gt; &gt; &gt; +				audit_log_format(ab, &quot; ino=%lu&quot;,
&gt; &gt; &gt; +					inode-&gt;i_ino);
&gt; &gt; &gt; +				break;
&gt; &gt; &gt; +			}
&gt; &gt; &gt; +			}
&gt; &gt; &gt; +		}
&gt; &gt; &gt; +		audit_log_format(ab, &quot; capability=%d &quot;, a-&gt;u.cap_struct.cap);
&gt; &gt; &gt;   		break;

+       }
        case LSM_AUDIT_DATA_PATH: {
                struct inode *inode;

&gt; &gt; 
&gt; &gt; Will this break any existing userspace log parsers?
&gt; 
&gt; I'm hoping not given that we are only adding auxiliary fields and those are
&gt; already defined for other AVC audit messages.  ausearch appeared to work
&gt; fine.  Added the linux-audit mailing list to the cc line to get their view.

Generally, additional or optional fields should only be added after
existing ones.  Also, generally, fields should not be optional, but this
is tricky since it gobbles network and cpu bandwidth and disk space and
there are lots of precedents to contradict this.


- RGB

--
Richard Guy Briggs &lt;rgb@xxxxxxxxxx&gt;
Sr. S/W Engineer, Kernel Security, Base Operating Systems
Remote, Ottawa, Red Hat Canada
IRC: rgb, SunRaycer
Voice: +1.647.777.2635, Internal: (81) 32635


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="29891" href="msg29891.html">[RFC PATCH] security,capability: pass object information to security_capable</a></strong>
<ul><li><em>From:</em> Nicholas Franck</li></ul></li>
<li><strong><a name="29892" href="msg29892.html">Re: [RFC PATCH] security,capability: pass object information to security_capable</a></strong>
<ul><li><em>From:</em> James Morris</li></ul></li>
<li><strong><a name="29894" href="msg29894.html">Re: [RFC PATCH] security, capability: pass object information to security_capable</a></strong>
<ul><li><em>From:</em> Stephen Smalley</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg29913.html">Re: [PATCH v4 0/3] initramfs: add support for xattrs in the initial ram disk</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg29915.html">Re: Preferred subj= with multiple LSMs</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg29894.html">Re: [RFC PATCH] security, capability: pass object information to security_capable</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg29893.html">Re: [RFC PATCH] security,capability: pass object information to security_capable</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#29914"><strong>Date</strong></a></li>
<li><a href="index.html#29914"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-users/>[Fedora&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
