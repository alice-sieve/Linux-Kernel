<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re: [RFC PATCH v3 09/12] LSM: x86/sgx: Introduce &#45;>enclave_load() hook for Intel SGX -->
<!--X-From-R13: "Re. Uert" &#60;tertNrawryyvp.pbz> -->
<!--X-Date: Sun, 23 Jun 2019 10:17:25 &#45;0700 -->
<!--X-Message-Id: 20190623171626.GA25683@wind.enjellic.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20190617222438.2080&#45;1&#45;sean.j.christopherson@intel.com -->
<!--X-Reference: 20190617222438.2080&#45;10&#45;sean.j.christopherson@intel.com -->
<!--X-Reference: 0c4f75a0ae2fdeee6db07f3a224918f321163d56.camel@linux.intel.com -->
<!--X-Reference: alpine.LRH.2.21.1906200702040.28119@namei.org -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Linux Security Module, Re: [RFC PATCH v3 09/12] LSM: x86/sgx: Introduce -&gt;enclave_load() hook for Intel SGX">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Linux Security Module -- Re: [RFC PATCH v3 09/12] LSM: x86/sgx: Introduce -&gt;enclave_load() hook for Intel SGX</title>
<link rel="alternate" type="application/rss+xml" title="Linux Security Module" href="//feeds.feedburner.com/LinuxSecurityModule">
</head>
<body vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">Re: [RFC PATCH v3 09/12] LSM: x86/sgx: Introduce -&gt;enclave_load() hook for Intel SGX</h1>
[<a href="msg29263.html">Date Prev</a>][<a href="msg29265.html">Date Next</a>][<a href="msg29183.html">Thread Prev</a>][<a href="msg29396.html">Thread Next</a>][<a href="maillist.html#29264">Date Index</a>][<a href="index.html#29264">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: Re: [RFC PATCH v3 09/12] LSM: x86/sgx: Introduce -&gt;enclave_load() hook for Intel SGX</li>
<li><em>From</em>: &quot;Dr. Greg&quot; &lt;greg@xxxxxxxxxxxx&gt;</li>
<li><em>Date</em>: Sun, 23 Jun 2019 12:16:26 -0500</li>
<li><em>Cc</em>: Jarkko Sakkinen &lt;jarkko.sakkinen@xxxxxxxxxxxxxxx&gt;,        Sean Christopherson &lt;sean.j.christopherson@xxxxxxxxx&gt;,        linux-sgx@xxxxxxxxxxxxxxx, Dave Hansen &lt;dave.hansen@xxxxxxxxx&gt;,        Cedric Xing &lt;cedric.xing@xxxxxxxxx&gt;, Andy Lutomirski &lt;luto@xxxxxxxxxx&gt;,        Jethro Beekman &lt;jethro@xxxxxxxxxxxx&gt;,        Stephen Smalley &lt;sds@xxxxxxxxxxxxx&gt;, casey.schaufler@xxxxxxxxx,        william.c.roberts@xxxxxxxxx, linux-security-module@xxxxxxxxxxxxxxx,        selinux@xxxxxxxxxxxxxxx</li>
<li><em>In-reply-to</em>: &lt;alpine.LRH.2.21.1906200702040.28119@namei.org&gt;</li>
<li><em>References</em>: &lt;20190617222438.2080-1-sean.j.christopherson@intel.com&gt; &lt;20190617222438.2080-10-sean.j.christopherson@intel.com&gt; &lt;0c4f75a0ae2fdeee6db07f3a224918f321163d56.camel@linux.intel.com&gt; &lt;alpine.LRH.2.21.1906200702040.28119@namei.org&gt;</li>
<li><em>Reply-to</em>: &quot;Dr. Greg&quot; &lt;greg@xxxxxxxxxxxx&gt;</li>
<li><em>User-agent</em>: Mutt/1.4i</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On Thu, Jun 20, 2019 at 07:13:50AM +1000, James Morris wrote:

Good morning, I hope the weekend has been going well for everyone.

&gt; On Wed, 19 Jun 2019, Jarkko Sakkinen wrote:
&gt; 
&gt; &gt; Can LSM callbacks ever non-generic when it comes to hardware? This is
&gt; &gt; the very first time I ever see such callbacks being introduced.
&gt; &gt; 
&gt; &gt; I suspect that from maintainers perspective, accepting such changes for
&gt; &gt; Intel hardware, could open a pandoras box.

&gt; If there's a major distro/userbase committing to ship with these
&gt; hooks enabled via a supported in-tree LSM, the case for inclusion is
&gt; clear.

I see that Jarkko responded down thread that there may be a major
distribution already committed to SGX specific LSM hooks.  My
apologies for providing these reflections if that is the case and
there is some type of 'deal' in place with respect to all of this.

&gt; If the hooks could be generalized beyond just SGX, that would be
&gt; ideal, but it's not clear if that's feasible.

We believe there is some degree of commonality that can be addressed
with respect to implementing LSM enforcement over SGX enclaves.

However, big picture, here is the challenge that we see with respect
to these conversations surrounding the integration of the SGX driver
with the LSM:

As a technology, SGX was designed to enable software to protect itself
from an adversarial operating system and hardware platform.  Given
that, if we are intellectually honest, how effective can the LSM/OS be
with respect to controlling the actions of an enclave?

Without question, being able to regulate and control which identities
can intersect to load executable content into an enclave is important.
All of the infrastructure appears to be already there to accomplish
that, given the default model of a shared library implementation of an
enclave and requiring the loader to mmap file backed TEXT pages RX.

The most relevant and important control with respect to whether or not
an enclave should be allowed to execute is evaluation of the
SIGSTRUCT.  Given the trajectory that platform security is on, SGX is
not going to be the last technology of its type nor the only
technology that makes use of cryptographically based code provenance.

As a result, if we are content with handing an opaque pointer of a
descriptive struture to an LSM routine, a generic hook that is tasked
with verifying code or execution environment provenance doesn't seem
like it would need to be technology specific nor controversial.

That leaves as the last thorny issue the question of dynamic
allocation of memory for executable content.  As we have stated
before, and at the outset of this note, from a security perspective
this is only, effectively, a binary question for the platform owner as
to whether or not the concept should be allowed.

A generic LSM hook, appropriately named, could execute that decision
without being SGX specific.  Arguably, the hook should be named to
indicate that it is seeking approval for allocating memory to be used
for anonymous executable content, since that is what it would be
effectively requesting approval for, in the case of SGX.

For completeness a third generic hook may be useful.  The purpose of
that hook would be to verify a block of memory as being
measured or signed for consideration as executable content.  Arguably
that will have utility far beyond SGX.

In the case of SGX it would address the issue as to whether or not a
block of executable content in untrusted space is eligible for
anonymous execution.  That may be a useful security measure in order
to provide some control over an enclave being used as a random
execution oracle.

It obviously has no security utility against the enclave author since,
as we have noted before, it is possible for the enclave author to
simply pull whatever code is desired over an encrypted network
connection.

&gt; James Morris

Hopefully these comments are a useful basis for further discussion.

Best wishes for a productive week to everyone.

Dr. Greg

As always,
Dr. Greg Wettstein, Ph.D, Worker
IDfusion, LLC
4206 N. 19th Ave.           Implementing measured information privacy
Fargo, ND  58102            and integrity architectures.
PH: 701-281-1686
FAX: 701-281-3949           EMAIL: gw@xxxxxxxxxxxx
------------------------------------------------------------------------------
&quot;My thoughts on trusting Open-Source?  A quote I once saw said it
 best: 'Remember, Amateurs built the ark.  Professionals built the
 Titanic.'  Perhaps most significantly the ark was one guy, there were
 no doubt committees involved with the Titanic project.&quot;
                                -- Dr. G.W. Wettstein
                                   Resurrection


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="29396" href="msg29396.html">Re: [RFC PATCH v3 09/12] LSM: x86/sgx: Introduce -&gt;enclave_load() hook for Intel SGX</a></strong>
<ul><li><em>From:</em> James Morris</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg29263.html">Re: [PATCH V34 20/29] x86/mmiotrace: Lock down the testmmiotrace module</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg29265.html">Re: [PATCH V31 07/25] kexec_file: Restrict at runtime if the kernel is locked down</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg29183.html">[PATCH V34 00/29] Lockdown as an LSM</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg29396.html">Re: [RFC PATCH v3 09/12] LSM: x86/sgx: Introduce -&gt;enclave_load() hook for Intel SGX</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#29264"><strong>Date</strong></a></li>
<li><a href="index.html#29264"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-users/>[Fedora&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
