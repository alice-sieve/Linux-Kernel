<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re:  [osinfo&#45;db&#45;tools PATCH 2/8] Add support to meson build system -->
<!--X-From-R13: Bniry Veqvan &#60;cueqvanNerqung.pbz> -->
<!--X-Date: Thu, 20 Jun 2019 09:42:47 &#45;0700 -->
<!--X-Message-Id: 20190620164229.GA10356@antique&#45;laptop -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 20190620152127.30892&#45;1&#45;fidencio@redhat.com -->
<!--X-Reference: 20190620152127.30892&#45;3&#45;fidencio@redhat.com -->
<!--X-Derived: pgpZU6L2cbOLl.pgp -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<title>Re:  [osinfo-db-tools PATCH 2/8] Add support to meson build system &mdash; libosinfo</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="libosinfo: Re:  [osinfo-db-tools PATCH 2/8] Add support to meson build system">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<link rel="alternate" type="application/rss+xml" title="libosinfo" href="//feeds.feedburner.com/libosinfo">
</head>
<body itemscope itemtype="//schema.org/Article" vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">Re:  [osinfo-db-tools PATCH 2/8] Add support to meson build system</h1>
[<a href="msg05870.html">Date Prev</a>][<a href="msg05872.html">Date Next</a>][<a href="msg05864.html">Thread Prev</a>][<a href="msg05874.html">Thread Next</a>][<a href="maillist.html#05871">Date Index</a>][<a href="index.html#05871">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: Re:  [osinfo-db-tools PATCH 2/8] Add support to meson build system</li>
<li><em>From</em>: Pavel Hrdina &lt;phrdina@xxxxxxxxxx&gt;</li>
<li><em>Date</em>: Thu, 20 Jun 2019 18:42:29 +0200</li>
<li><em>Cc</em>: libosinfo@xxxxxxxxxx, feborges@xxxxxxxxxx</li>
<li><em>In-reply-to</em>: &lt;<a href="msg05864.html">20190620152127.30892-3-fidencio@redhat.com</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg05862.html">20190620152127.30892-1-fidencio@redhat.com</a>&gt;	&lt;<a href="msg05864.html">20190620152127.30892-3-fidencio@redhat.com</a>&gt;</li>
<li><em>User-agent</em>: Mutt/1.11.4 (2019-03-13)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On Thu, Jun 20, 2019 at 05:21:21PM +0200, Fabiano Fid&#xEA;ncio wrote:
&gt; Meson build system is a way simpler and easier to understand build
&gt; system that can provide (with some work-arounds here and there) the same
&gt; functionalities currently available with our current build system
&gt; (autotools).
&gt; 
&gt; For now, as meson support is not fully complete* and requires a quite
&gt; new version of meson still not present in all systems supported on
&gt; libvirt-jenkis-ci, let's keep autotools around so more extensive testing
&gt; if meson's functionalities can be done before actually removing
&gt; autotools support.
&gt; 
&gt; *: the support is not fully complete as there's still no equivalent of
&gt; `make syntax-check` provided.
&gt; 
&gt; A quite nice description of meson, ninja, and their workflow was part of
&gt; the spice* commits introducing support to meson/ninja and is copied
&gt; below:
&gt; ```
&gt; - Meson: <a  rel="nofollow" href="https://mesonbuild.com">https://mesonbuild.com</a>
&gt; 
&gt;   This is the equivalent of autogen/configure step in autotools. It
&gt;   generates the files that will be used by ninja to actually build the
&gt;   source code.
&gt; 
&gt;   The project has received lots of traction recently, with many GNOME
&gt;   projects willing to move to this new build system. The following wiki
&gt;   page has more details of the status of the many projects being ported:
&gt; 
&gt;     <a  rel="nofollow" href="https://wiki.gnome.org/Initiatives/GnomeGoals/MesonPorting">https://wiki.gnome.org/Initiatives/GnomeGoals/MesonPorting</a>
&gt; 
&gt;   Meson has a python-like syntax, easy to read, and the documentation
&gt;   on the project is very complete, with a dedicated page on how to port
&gt;   from autotools, explaining how most common use cases can be
&gt;   implemented using meson.
&gt; 
&gt;     <a  rel="nofollow" href="http://mesonbuild.com/Porting-from-autotools.html">http://mesonbuild.com/Porting-from-autotools.html</a>
&gt; 
&gt;   Other important sources of information:
&gt; 
&gt;     <a  rel="nofollow" href="http://mesonbuild.com/howtox.html">http://mesonbuild.com/howtox.html</a>
&gt;     <a  rel="nofollow" href="http://mesonbuild.com/Syntax.html">http://mesonbuild.com/Syntax.html</a>
&gt;     <a  rel="nofollow" href="http://mesonbuild.com/Reference-manual.html">http://mesonbuild.com/Reference-manual.html</a>
&gt; 
&gt; - Ninja: <a  rel="nofollow" href="https://ninja-build.org">https://ninja-build.org</a>
&gt; 
&gt;   Ninja is the equivalent of make in an autotools setup, which actually
&gt;   builds the source code. It has being used by large and complex
&gt;   projects such as Google Chrome, Android and LLVM. There is not much to
&gt;   say about ninja (other than it is much faster than make) because we
&gt;   won't interact directly with it as much, as meson does the middle man
&gt;   job here. The reasoning for creating ninja in the first place is
&gt;   explained on the following post:
&gt; 
&gt;     <a  rel="nofollow" href="http://neugierig.org/software/chromium/notes/2011/02/ninja.html">http://neugierig.org/software/chromium/notes/2011/02/ninja.html</a>
&gt; 
&gt;   Also its manual provides more in-depth information about the design
&gt;   principles:
&gt; 
&gt;     <a  rel="nofollow" href="https://ninja-build.org/manual.html">https://ninja-build.org/manual.html</a>
&gt; 
&gt; - Basic workflow:
&gt; 
&gt;   Meson package is available for most if not all distros, so, taking
&gt;   Fedora as an example, we only need to run:
&gt; 
&gt;     # dnf -y install meson ninja-build.
&gt; 
&gt;   With Meson, building in-tree is not possible at all, so we need to
&gt;   pass a directory as argument to meson where we want the build to be
&gt;   done. This has the advantage of creating builds with different options
&gt;   under the same parent directory, e.g.:
&gt; 
&gt;     $ meson ./build --prefix=/usr
&gt;     $ meson ./build-extra -Dextra-checks=true -Dalignment-checks=true
&gt; 
&gt;   After configuration is done, we call ninja to actually do the build.
&gt; 
&gt;     $ ninja -C ./build
&gt;     $ ninja -C ./build install
&gt; 
&gt; - Hacking:
&gt; 
&gt;   * meson.build: Mandatory for the project root and usually found under
&gt;                  each directory you want something to be built.
&gt; ```

I'm not sure if this should be part of the commit message, personally I
would prefer to have it as part of README or HACKING or something like
that where it is visible even from tarball.

Few more notes that I've noticed:

    - There is a regression, with meson we no longer have generated RPM
      spec files in tarball.

    - With autotools there were some configure options:
        --enable-vala [default check]
        --enable-coverage [default no]
        --with-usb-ids-path [default (internal)]
        --with-pci-ids-path [default (internal)]
        --enable-werror [default git ? yes : no ]

    - I'm not sure what are the best practices, but basically all of the
      projects using meson that I've check have the generic things like
      dependencies, compiler flags and so on in the root meson.build
      file.  All the other meson.build files handles only the
      compilation or code generation, ... for the specific directory.

Otherwise looks good to me, but I've just started with meson myself so
we should get some other reviews (yes, probably Daniel :)).

Pavel
</pre><p><strong>Attachment:
<a href="attachments/pgpZU6L2cbOLl.pgp" ><tt>signature.asc</tt></a></strong><br>
<em>Description:</em> PGP signature</p>
<pre>_______________________________________________
Libosinfo mailing list
Libosinfo@xxxxxxxxxx
<a  rel="nofollow" href="https://www.redhat.com/mailman/listinfo/libosinfo">https://www.redhat.com/mailman/listinfo/libosinfo</a>
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg05870.html">[osinfo-db-tools PATCH 8/8] prepare-relase: Add `ninja	syntax-check`</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg05872.html">Re:  [osinfo-db-tools PATCH 1/8] tools: Don't import config.h</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg05864.html">[osinfo-db-tools PATCH 2/8] Add support to meson build	system</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg05874.html">Re:  [osinfo-db-tools PATCH 2/8] Add support to meson build system</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#05871"><strong>Date</strong></a></li>
<li><a href="index.html#05871"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/lists/virt-tools/>[Virt&nbsp;Tools]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/libvirt-users/>[Libvirt&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-users/>[Fedora&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-maintainers/>[Fedora&nbsp;Maintainers]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=http://www.ske-art.com/z/biglist.html>[Big&nbsp;List&nbsp;of&nbsp;Linux&nbsp;Books]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
</font>
</center>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
