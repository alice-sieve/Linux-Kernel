<!-- MHonArc v2.6.19 -->
<!--X-Subject: [osinfo&#45;db PATCH 09/16] install&#45;script, opensuse,	desktop: Add avatar&#45;disk template -->
<!--X-From-R13: =?GFT&#45;8?d?Tnovnab=20Tvq=Q3=OOapvb?= &#60;svqrapvbNerqung.pbz> -->
<!--X-Date: Tue, 18 Jun 2019 12:07:03 &#45;0700 -->
<!--X-Message-Id: 20190618190632.14411&#45;10&#45;fidencio@redhat.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20190618190632.14411&#45;1&#45;fidencio@redhat.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<title>[osinfo-db PATCH 09/16] install-script, opensuse,	desktop: Add avatar-disk template &mdash; libosinfo</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="libosinfo: [osinfo-db PATCH 09/16] install-script, opensuse,	desktop: Add avatar-disk template">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<link rel="alternate" type="application/rss+xml" title="libosinfo" href="//feeds.feedburner.com/libosinfo">
</head>
<body itemscope itemtype="//schema.org/Article" vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">[osinfo-db PATCH 09/16] install-script, opensuse,	desktop: Add avatar-disk template</h1>
[<a href="msg05852.html">Date Prev</a>][<a href="msg05854.html">Date Next</a>][<a href="msg05852.html">Thread Prev</a>][<a href="msg05854.html">Thread Next</a>][<a href="maillist.html#05853">Date Index</a>][<a href="index.html#05853">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: [osinfo-db PATCH 09/16] install-script, opensuse,	desktop: Add avatar-disk template</li>
<li><em>From</em>: Fabiano Fid&#xEA;ncio &lt;fidencio@xxxxxxxxxx&gt;</li>
<li><em>Date</em>: Tue, 18 Jun 2019 21:06:25 +0200</li>
<li><em>In-reply-to</em>: &lt;<a href="msg05843.html">20190618190632.14411-1-fidencio@redhat.com</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg05843.html">20190618190632.14411-1-fidencio@redhat.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Let's add the avatar disk template, which considers that the avatar file
is stored together with the install scripts files, so we don't actually
require the apps to set it (but, if they do, the value set will be
used).

Signed-off-by: Fabiano Fid&#xEA;ncio &lt;fidencio@xxxxxxxxxx&gt;
---
 .../opensuse.org/opensuse-autoyast-desktop.xml.in | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/data/install-script/opensuse.org/opensuse-autoyast-desktop.xml.in b/data/install-script/opensuse.org/opensuse-autoyast-desktop.xml.in
index dfbe176..38e2c92 100644
--- a/data/install-script/opensuse.org/opensuse-autoyast-desktop.xml.in
+++ b/data/install-script/opensuse.org/opensuse-autoyast-desktop.xml.in
@@ -49,6 +49,19 @@
           &lt;/xsl:choose&gt;
         &lt;/xsl:template&gt;
 
+        &lt;!-- The default values of avatar-disk consider the avatar is stored
+             in the same disk as the installation scripts. --&gt;
+        &lt;xsl:template name=&quot;avatar-disk&quot;&gt;
+          &lt;xsl:choose&gt;
+            &lt;xsl:when test=&quot;config/avatar-disk != ''&quot;&gt;
+              &lt;xsl:value-of select=&quot;config/avatar-disk&quot;/&gt;
+            &lt;/xsl:when&gt;
+            &lt;xsl:otherwise&gt;
+              &lt;xsl:text&gt;/dev/sda&lt;/xsl:text&gt;
+            &lt;/xsl:otherwise&gt;
+          &lt;/xsl:choose&gt;
+        &lt;/xsl:template&gt;
+
         &lt;xsl:template name=&quot;l10n-language&quot;&gt;
           &lt;xsl:choose&gt;
             &lt;xsl:when test=&quot;config/l10n-language != '' and config/l10n-language != 'C'&quot;&gt;
@@ -269,7 +282,7 @@ fi
 if test -n '&lt;xsl:value-of select=&quot;config/avatar-location&quot;/&gt;'; then
 # Set user avatar
 mkdir /mnt/unattended-media
-mount &lt;xsl:value-of select='config/avatar-disk'/&gt; /mnt/unattended-media
+mount &lt;xsl:call-template name=&quot;avatar-disk&quot;/&gt; /mnt/unattended-media
 cp /mnt/unattended-media&lt;xsl:value-of select=&quot;config/avatar-location&quot;/&gt; /var/lib/AccountsService/icons/&lt;xsl:value-of select=&quot;config/user-login&quot;/&gt;
 umount /mnt/unattended-media
 
-- 
2.21.0

_______________________________________________
Libosinfo mailing list
Libosinfo@xxxxxxxxxx
<a  rel="nofollow" href="https://www.redhat.com/mailman/listinfo/libosinfo">https://www.redhat.com/mailman/listinfo/libosinfo</a>



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg05852.html">[osinfo-db PATCH 08/16] install-script,	opensuse: Add target-disk template</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg05854.html">[osinfo-db PATCH 10/16] install-script,	rhel: Only use virtio for 5.6+</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg05852.html">[osinfo-db PATCH 08/16] install-script,	opensuse: Add target-disk template</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg05854.html">[osinfo-db PATCH 10/16] install-script,	rhel: Only use virtio for 5.6+</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#05853"><strong>Date</strong></a></li>
<li><a href="index.html#05853"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/lists/virt-tools/>[Virt&nbsp;Tools]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/libvirt-users/>[Libvirt&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-users/>[Fedora&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-maintainers/>[Fedora&nbsp;Maintainers]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=http://www.ske-art.com/z/biglist.html>[Big&nbsp;List&nbsp;of&nbsp;Linux&nbsp;Books]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
</font>
</center>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
