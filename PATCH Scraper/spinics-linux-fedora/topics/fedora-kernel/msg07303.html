<!-- MHonArc v2.6.19 -->
<!--X-Subject: [PATCH 2/2] drm/i915/dp: Restrict link retrain workaround to external monitors -->
<!--X-From-R13: Zlhqr Bnhy &#60;ylhqrNerqung.pbz> -->
<!--X-Date: Mon, 22 Oct 2018 12:28:59 &#45;0700 -->
<!--X-Message-Id: 20181022192831.21139&#45;3&#45;lyude@redhat.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20181022192831.21139&#45;1&#45;lyude@redhat.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description content="[PATCH 2/2] drm/i915/dp: Restrict link retrain workaround to external monitors &mdash; Fedora Linux Kernel">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>[PATCH 2/2] drm/i915/dp: Restrict link retrain workaround to external monitors &mdash; Fedora Linux Kernel</title>
<link rel="alternate" type="application/rss+xml" title="Fedora Linux Kernel" href="//feeds.feedburner.com/FedoraKernel">
</head>
<body itemscope itemtype="//schema.org/Article" vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en" async defer></script>
<h1 itemprop="name">[PATCH 2/2] drm/i915/dp: Restrict link retrain workaround to external monitors</h1>
[<a href="msg07302.html">Date Prev</a>][<a href="msg07304.html">Date Next</a>][<a href="msg07302.html">Thread Prev</a>][<a href="msg07304.html">Thread Next</a>][<a href="maillist.html#07303">Date Index</a>][<a href="index.html#07303">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: [PATCH 2/2] drm/i915/dp: Restrict link retrain workaround to external monitors</li>
<li><em>From</em>: Lyude Paul &lt;lyude@xxxxxxxxxx&gt;</li>
<li><em>Date</em>: Mon, 22 Oct 2018 15:28:31 -0400</li>
<li><em>Cc</em>: Justin Forbes &lt;jforbes@xxxxxxxxxx&gt;</li>
<li><em>In-reply-to</em>: &lt;<a href="msg07301.html">20181022192831.21139-1-lyude@redhat.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>From: Dhinakaran Pandiyan &lt;dhinakaran.pandiyan@xxxxxxxxx&gt;

Commit '3cf71bc9904d (&quot;drm/i915: Re-apply &quot;Perform link quality check,
unconditionally during long pulse&quot;&quot;)' applies a work around for sinks
that don't signal link loss. The work around does not need to have to be
that broad as the issue was seen with only one particular monitor; limit
this only for external displays as eDP features like PSR turn off the link
and the driver ends up retraining the link seeeing that link is not
synchronized.

Cc: Lyude Paul &lt;lyude@xxxxxxxxxx&gt;
Cc: Jan-Marek Glogowski &lt;glogow@xxxxxxxxxx&gt;
Cc: Ville Syrj&#xE4;l&#xE4; &lt;ville.syrjala@xxxxxxxxxxxxxxx&gt;
Cc: Rodrigo Vivi &lt;rodrigo.vivi@xxxxxxxxx&gt;
References: 3cf71bc9904d (&quot;drm/i915: Re-apply &quot;Perform link quality check, unconditionally during long pulse&quot;&quot;)
Signed-off-by: Dhinakaran Pandiyan &lt;dhinakaran.pandiyan@xxxxxxxxx&gt;
Reviewed-by: Ville Syrj&#xE4;l&#xE4; &lt;ville.syrjala@xxxxxxxxxxxxxxx&gt;
Link: <a  rel="nofollow" href="https://patchwork.freedesktop.org/patch/msgid/20180927205735.16651-2-dhinakaran.pandiyan@xxxxxxxxx">https://patchwork.freedesktop.org/patch/msgid/20180927205735.16651-2-dhinakaran.pandiyan@xxxxxxxxx</a>
Signed-off-by: Lyude Paul &lt;lyude@xxxxxxxxxx&gt;
---
 drivers/gpu/drm/i915/intel_dp.c | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

diff --git a/drivers/gpu/drm/i915/intel_dp.c b/drivers/gpu/drm/i915/intel_dp.c
index 29cf7695e4c0..5314cff72f17 100644
--- a/drivers/gpu/drm/i915/intel_dp.c
+++ b/drivers/gpu/drm/i915/intel_dp.c
@@ -4842,12 +4842,13 @@ intel_dp_long_pulse(struct intel_connector *connector,
 		 */
 		status = connector_status_disconnected;
 		goto out;
-	} else {
-		/*
-		 * Some external monitors do not signal loss of link
-		 * synchronization with an IRQ_HPD, so force a link status
-		 * check.
-		 */
+	}
+
+	/*
+	 * Some external monitors do not signal loss of link synchronization
+	 * with an IRQ_HPD, so force a link status check.
+	 */
+	if (!intel_dp_is_edp(intel_dp)) {
 		struct intel_encoder *encoder = &amp;dp_to_dig_port(intel_dp)-&gt;base;
 
 		intel_dp_retrain_link(encoder, ctx);
-- 
2.17.2
_______________________________________________
kernel mailing list -- kernel@xxxxxxxxxxxxxxxxxxxxxxx
To unsubscribe send an email to kernel-leave@xxxxxxxxxxxxxxxxxxxxxxx
Fedora Code of Conduct: <a  rel="nofollow" href="https://getfedora.org/code-of-conduct.html">https://getfedora.org/code-of-conduct.html</a>
List Guidelines: <a  rel="nofollow" href="https://fedoraproject.org/wiki/Mailing_list_guidelines">https://fedoraproject.org/wiki/Mailing_list_guidelines</a>
List Archives: <a  rel="nofollow" href="https://lists.fedoraproject.org/archives/list/kernel@xxxxxxxxxxxxxxxxxxxxxxx">https://lists.fedoraproject.org/archives/list/kernel@xxxxxxxxxxxxxxxxxxxxxxx</a>



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="07301" href="msg07301.html">[PATCH 0/2] Important i915 eDP fixes for F28/29</a></strong>
<ul><li><em>From:</em> Lyude Paul</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg07302.html">[PATCH 1/2] drm/i915/dp: Fix link retraining comment in intel_dp_long_pulse()</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg07304.html">[PATCH] Fix cross kernel headers location - rhbz#1642037</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg07302.html">[PATCH 1/2] drm/i915/dp: Fix link retraining comment in intel_dp_long_pulse()</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg07304.html">[PATCH] Fix cross kernel headers location - rhbz#1642037</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#07303"><strong>Date</strong></a></li>
<li><a href="index.html#07303"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-users/>[Fedora&nbsp;General&nbsp;Discussion]</a>
&nbsp;
&nbsp;
<a href=http://lists.linuxcoding.com/rhl/>[Older&nbsp;Fedora&nbsp;Users&nbsp;Archive]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-advisory-board/>[Fedora&nbsp;Advisory&nbsp;Board]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-security/>[Fedora&nbsp;Security]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-devel-java/>[Fedora&nbsp;Devel&nbsp;Java]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-legacy/>[Fedora&nbsp;Legacy]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/ataraid/>[ATA&nbsp;RAID]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-marketing/>[Fedora&nbsp;Marketing]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-mentors/>[Fedora&nbsp;Mentors]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-package-announce/>[Fedora&nbsp;Package&nbsp;Announce]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-package-review/>[Fedora&nbsp;Package&nbsp;Review]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-music/>[Fedora&nbsp;Music]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-packaging/>[Fedora&nbsp;Packaging]</a>
&nbsp;
&nbsp;
<a href=/lists/centos/>[Centos]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/coolkey/>[Coolkey]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/yum/>[Yum&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/tux/>[Tux]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-art/>[Fedora&nbsp;Art]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-docs/>[Fedora&nbsp;Docs]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-usb/>[USB]</a>
&nbsp;
&nbsp;
<a href=/lists/asterisk/>[Asterisk&nbsp;PBX]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
