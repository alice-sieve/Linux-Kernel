<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5&#45;level page tables -->
<!--X-From-R13: Rnir Oaqrefba &#60;naqrefbaNerqung.pbz> -->
<!--X-Date: Tue, 16 Jan 2018 12:38:28 &#45;0800 -->
<!--X-Message-Id: 1400189443.365687.1516135059024.JavaMail.zimbra@redhat.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20180112101256.6934&#45;1&#45;douly.fnst@cn.fujitsu.com -->
<!--X-Reference: 1245943115.5163992.1515790578320.JavaMail.zimbra@redhat.com -->
<!--X-Reference: c1cef3c0&#45;80d5&#45;aaa3&#45;dbc3&#45;bbe9040e09d8@cn.fujitsu.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables &mdash; Red Hat Crash Utility">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Red Hat Crash Utility &mdash;  Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</title>
<link rel="alternate" type="application/rss+xml" title="Red Hat Crash Utility" href="//feeds.feedburner.com/RedHatCrashUtility">
</head>
<body itemscope itemtype="//schema.org/Article" vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</h1>
[<a href="msg07264.html">Date Prev</a>][<a href="msg07266.html">Date Next</a>][<a href="msg07264.html">Thread Prev</a>][<a href="msg07266.html">Thread Next</a>][<a href="maillist.html#07265">Date Index</a>][<a href="index.html#07265">Thread Index</a>]
<script src="https://apis.google.com/js/platform.js" async defer></script>
<g:plusone size="small"></g:plusone>
<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</li>
<li><em>From</em>: Dave Anderson &lt;anderson@xxxxxxxxxx&gt;</li>
<li><em>Date</em>: Tue, 16 Jan 2018 15:37:39 -0500 (EST)</li>
<li><em>Cc</em>: fnstml-iaas@xxxxxxxxxxxxxx, crash-utility@xxxxxxxxxx</li>
<li><em>In-reply-to</em>: &lt;<a href="msg07264.html">c1cef3c0-80d5-aaa3-dbc3-bbe9040e09d8@cn.fujitsu.com</a>&gt;</li>
<li><em>Reply-to</em>: &quot;Discussion list for crash utility usage,	maintenance and development&quot; &lt;crash-utility@xxxxxxxxxx&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" defer async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>

----- Original Message -----
&gt;<i> Hi Dave,</i>
&gt;<i> </i>
&gt;<i> At 01/13/2018 04:56 AM, Dave Anderson wrote:</i>
&gt;<i> &gt; </i>
&gt;<i> &gt; Hi Dou,</i>
&gt;<i> &gt; </i>
&gt;<i> &gt; This v2 version tests OK on my sample set of dumpfiles.  I didn't</i>
&gt;<i> &gt; get a chance to fully review the patchset, and I will be out of the</i>
&gt;<i> &gt; office until next Tuesday.  I'll try to review the patches then.</i>
&gt;<i> </i>
&gt;<i> Thank you for telling me that.</i>
&gt;<i> </i>
&gt;<i> I also test this patchset with *sadump* file with my colleagues. it is</i>
&gt;<i> OK too.</i>
&gt;<i> </i>
&gt;<i> And I am trying to make the 5-level page tables support for Xen.</i>
&gt;<i> </i>
&gt;<i> Thanks,</i>
&gt;<i> 	dou.</i>


Hello Dou,

Completing my review may take me longer than expected due to other tasks
I have to take care of first.  Please excuse my delay.

However, I did notice one problem w/respect to your changes to defs.h.
When modifying any exported data structure in defs.h, be aware that the
change may break extension modules that have been previously compiled
against older versions of defs.h.
  
For example, the following changes to the x86_64 machine_specific data
structure would break extension modules that have been previously compiled
against earlier versions of defs.h -- if the extension module uses fields in
the machine_specific data structure that come after the members that you
have removed:

@@ -5747,10 +5735,6 @@ struct machine_specific {
        ulong modules_vaddr;
        ulong modules_end;
        ulong phys_base;
-        char *pml4;
-       char *upml;
-       ulong last_upml_read;
-       ulong last_pml4_read;
        char *irqstack;
        ulong irq_eframe_link;
        struct x86_64_pt_regs_offsets pto;
@@ -5765,6 +5749,7 @@ struct machine_specific {
        ulong kernel_image_size;
        ulong physical_mask_shift;
        ulong pgdir_shift;
+       ulong ptrs_per_pgd;
         char *p4d;
        ulong last_p4d_read;
        struct ORC_data orc;

So in the situation above:

 (1) Please do not remove the pml4, upml, last_upml_read and last_pml4_read members.
     (You could add an &quot;/* obsolete */&quot; comment after them if you'd like.)
 (2) When adding a new member such as ptrs_per_pgd above, please place it at the
     end of the machine_specific data structure.  

That way, the member offsets of the original structure members would not change
and previously compiled extension modules would be unaffected.

Thanks,
  Dave

--
Crash-utility mailing list
Crash-utility@xxxxxxxxxx
<a  rel="nofollow" href="https://www.redhat.com/mailman/listinfo/crash-utility">https://www.redhat.com/mailman/listinfo/crash-utility</a>


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="07285" href="msg07285.html">Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</a></strong>
<ul><li><em>From:</em> Dave Anderson</li></ul></li>
<li><strong><a name="07266" href="msg07266.html">Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</a></strong>
<ul><li><em>From:</em> Dou Liyang</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="07256" href="msg07256.html">[PATCH v2 0/6] Second phase of future support for	x86_64 5-level page tables</a></strong>
<ul><li><em>From:</em> Dou Liyang</li></ul></li>
<li><strong><a name="07263" href="msg07263.html">Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</a></strong>
<ul><li><em>From:</em> Dave Anderson</li></ul></li>
<li><strong><a name="07264" href="msg07264.html">Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</a></strong>
<ul><li><em>From:</em> Dou Liyang</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg07264.html">Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg07266.html">Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg07264.html">Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg07266.html">Re:  [PATCH v2 0/6] Second phase of future support for x86_64 5-level page tables</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#07265"><strong>Date</strong></a></li>
<li><a href="index.html#07265"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-devel/>[Fedora&nbsp;Development]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-tools/>[Fedora&nbsp;Tools]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width="100%">
<tr>
<td align=left>&nbsp;</td>
<td valign=top align=right><H1><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></H1></td>
</tr></table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
