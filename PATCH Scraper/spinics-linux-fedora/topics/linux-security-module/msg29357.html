<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re: [PATCH bpf&#45;next v9 02/10] bpf: Add eBPF program subtype and is_valid_subtype() verifier -->
<!--X-From-R13: =?GFT&#45;8?C?[vpxn=p3=noy_Enyn=p3=opa?= &#60;zvpNqvtvxbq.arg> -->
<!--X-Date: Wed, 26 Jun 2019 00:35:49 &#45;0700 -->
<!--X-Message-Id: 1b87e170&#45;0779&#45;fad0&#45;f623&#45;8cf677843338@digikod.net -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20190625215239.11136&#45;1&#45;mic@digikod.net -->
<!--X-Reference: 20190625215239.11136&#45;3&#45;mic@digikod.net -->
<!--X-Reference: CAADnVQ+Twio22VSi21RR5TY1Zm&#45;1xRTGmREcXLSs5Jv&#45;KWGTiw@mail.gmail.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Linux Security Module, Re: [PATCH bpf-next v9 02/10] bpf: Add eBPF program subtype and is_valid_subtype() verifier">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Linux Security Module -- Re: [PATCH bpf-next v9 02/10] bpf: Add eBPF program subtype and is_valid_subtype() verifier</title>
<link rel="alternate" type="application/rss+xml" title="Linux Security Module" href="//feeds.feedburner.com/LinuxSecurityModule">
</head>
<body vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">Re: [PATCH bpf-next v9 02/10] bpf: Add eBPF program subtype and is_valid_subtype() verifier</h1>
[<a href="msg29356.html">Date Prev</a>][<a href="msg29358.html">Date Next</a>][<a href="msg29355.html">Thread Prev</a>][<a href="msg29346.html">Thread Next</a>][<a href="maillist.html#29357">Date Index</a>][<a href="index.html#29357">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: Re: [PATCH bpf-next v9 02/10] bpf: Add eBPF program subtype and is_valid_subtype() verifier</li>
<li><em>From</em>: Micka&#xEB;l Sala&#xFC;n &lt;mic@xxxxxxxxxxx&gt;</li>
<li><em>Date</em>: Wed, 26 Jun 2019 09:33:35 +0200</li>
<li><em>Cc</em>: LKML &lt;linux-kernel@xxxxxxxxxxxxxxx&gt;, Aleksa Sarai &lt;cyphar@xxxxxxxxxx&gt;,        Alexander Viro &lt;viro@xxxxxxxxxxxxxxxxxx&gt;,        Alexei Starovoitov &lt;ast@xxxxxxxxxx&gt;,        Andrew Morton &lt;akpm@xxxxxxxxxxxxxxxxxxxx&gt;,        Andy Lutomirski &lt;luto@xxxxxxxxxxxxxx&gt;,        Arnaldo Carvalho de Melo &lt;acme@xxxxxxxxxx&gt;,        Casey Schaufler &lt;casey@xxxxxxxxxxxxxxxx&gt;,        Daniel Borkmann &lt;daniel@xxxxxxxxxxxxx&gt;,        David Drysdale &lt;drysdale@xxxxxxxxxx&gt;,        &quot;David S . Miller&quot; &lt;davem@xxxxxxxxxxxxx&gt;,        &quot;Eric W . Biederman&quot; &lt;ebiederm@xxxxxxxxxxxx&gt;,        James Morris &lt;jmorris@xxxxxxxxx&gt;, Jann Horn &lt;jann@xxxxxxxxx&gt;,        John Johansen &lt;john.johansen@xxxxxxxxxxxxx&gt;,        Jonathan Corbet &lt;corbet@xxxxxxx&gt;, Kees Cook &lt;keescook@xxxxxxxxxxxx&gt;,        Michael Kerrisk &lt;mtk.manpages@xxxxxxxxx&gt;,        Micka&#xEB;l Sala&#xFC;n &lt;mickael.salaun@xxxxxxxxxxx&gt;,        Paul Moore &lt;paul@xxxxxxxxxxxxxx&gt;, Sargun Dhillon &lt;sargun@xxxxxxxxx&gt;,        &quot;Serge E . Hallyn&quot; &lt;serge@xxxxxxxxxx&gt;, Shuah Khan &lt;shuah@xxxxxxxxxx&gt;,        Stephen Smalley &lt;sds@xxxxxxxxxxxxx&gt;, Tejun Heo &lt;tj@xxxxxxxxxx&gt;,        Tetsuo Handa &lt;penguin-kernel@xxxxxxxxxxxxxxxxxxx&gt;,        Thomas Graf &lt;tgraf@xxxxxxx&gt;, Tycho Andersen &lt;tycho@xxxxxxxx&gt;,        Will Drewry &lt;wad@xxxxxxxxxxxx&gt;,        Kernel Hardening &lt;kernel-hardening@xxxxxxxxxxxxxxxxxx&gt;,        Linux API &lt;linux-api@xxxxxxxxxxxxxxx&gt;,        Linux-Fsdevel &lt;linux-fsdevel@xxxxxxxxxxxxxxx&gt;,        LSM List &lt;linux-security-module@xxxxxxxxxxxxxxx&gt;,        Network Development &lt;netdev@xxxxxxxxxxxxxxx&gt;</li>
<li><em>In-reply-to</em>: &lt;<a href="msg29355.html">CAADnVQ+Twio22VSi21RR5TY1Zm-1xRTGmREcXLSs5Jv-KWGTiw@mail.gmail.com</a>&gt;</li>
<li><em>Openpgp</em>: preference=signencrypt</li>
<li><em>References</em>: &lt;<a href="msg29352.html">20190625215239.11136-1-mic@digikod.net</a>&gt; &lt;<a href="msg29345.html">20190625215239.11136-3-mic@digikod.net</a>&gt; &lt;<a href="msg29355.html">CAADnVQ+Twio22VSi21RR5TY1Zm-1xRTGmREcXLSs5Jv-KWGTiw@mail.gmail.com</a>&gt;</li>
<li><em>User-agent</em>: </li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>

On 26/06/2019 01:02, Alexei Starovoitov wrote:
&gt; On Tue, Jun 25, 2019 at 3:04 PM Micka&#xEB;l Sala&#xFC;n &lt;mic@xxxxxxxxxxx&gt; wrote:
&gt;&gt;
&gt;&gt; The goal of the program subtype is to be able to have different static
&gt;&gt; fine-grained verifications for a unique program type.
&gt;&gt;
&gt;&gt; The struct bpf_verifier_ops gets a new optional function:
&gt;&gt; is_valid_subtype(). This new verifier is called at the beginning of the
&gt;&gt; eBPF program verification to check if the (optional) program subtype is
&gt;&gt; valid.
&gt;&gt;
&gt;&gt; The new helper bpf_load_program_xattr() enables to verify a program with
&gt;&gt; subtypes.
&gt;&gt;
&gt;&gt; For now, only Landlock eBPF programs are using a program subtype (see
&gt;&gt; next commits) but this could be used by other program types in the
&gt;&gt; future.
&gt;&gt;
&gt;&gt; Signed-off-by: Micka&#xEB;l Sala&#xFC;n &lt;mic@xxxxxxxxxxx&gt;
&gt;&gt; Cc: Alexei Starovoitov &lt;ast@xxxxxxxxxx&gt;
&gt;&gt; Cc: Daniel Borkmann &lt;daniel@xxxxxxxxxxxxx&gt;
&gt;&gt; Cc: David S. Miller &lt;davem@xxxxxxxxxxxxx&gt;
&gt;&gt; Link: <a  rel="nofollow" href="https://lkml.kernel.org/r/20160827205559.GA43880@xxxxxxxxxxxxxxxxxxxxxxx">https://lkml.kernel.org/r/20160827205559.GA43880@xxxxxxxxxxxxxxxxxxxxxxx</a>
&gt;&gt; ---
&gt;&gt;
&gt;&gt; Changes since v8:
&gt;&gt; * use bpf_load_program_xattr() instead of bpf_load_program() and add
&gt;&gt;   bpf_verify_program_xattr() to deal with subtypes
&gt;&gt; * remove put_extra() since there is no more &quot;previous&quot; field (for now)
&gt;&gt;
&gt;&gt; Changes since v7:
&gt;&gt; * rename LANDLOCK_SUBTYPE_* to LANDLOCK_*
&gt;&gt; * move subtype in bpf_prog_aux and use only one bit for has_subtype
&gt;&gt;   (suggested by Alexei Starovoitov)
&gt; 
&gt; sorry to say, but I don't think the landlock will ever land,
&gt; since posting huge patches once a year is missing a lot of development
&gt; that is happening during that time.

You're right that it's been a while since the last patch set, but the
main reasons behind this was a lack of feedback (probably because of the
size of the patch set, which is now reduce to a consistent minimum), the
rework needed to address everyone's concern (Landlock modify kernel
components from different maintainers), and above all, the LSM stacking
infrastructure which was quite beefy and then took some time to land:
<a  rel="nofollow" href="https://lore.kernel.org/lkml/50db058a-7dde-441b-a7f9-f6837fe8b69f@xxxxxxxxxxxxxxxx/">https://lore.kernel.org/lkml/50db058a-7dde-441b-a7f9-f6837fe8b69f@xxxxxxxxxxxxxxxx/</a>
This stacking infrastructure was required to have a useful version of
Landlock (which is used as a use case example), and it was released with
Linux v5.1 (last month). Now, I think everything is finally ready to
move forward.

&gt; This 2/10 patch is an example.
&gt; subtype concept was useful 2 years ago when v6 was posted.
&gt; Since then bpf developers faced very similar problem in other parts
&gt; and it was solved with 'expected_attach_type' field.
&gt; See commit 5e43f899b03a (&quot;bpf: Check attach type at prog load time&quot;)
&gt; dated March 2018.

I saw this nice feature but I wasn't sure if it was the right field to
use. Indeed, I need more than a &quot;type&quot;, but also some values (triggers)
as shown by this patch. What do you suggest?


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="29352" href="msg29352.html">[PATCH bpf-next v9 00/10] Landlock LSM: Toward unprivileged sandboxing</a></strong>
<ul><li><em>From:</em> Micka&#xEB;l Sala&#xFC;n</li></ul></li>
<li><strong><a name="29345" href="msg29345.html">[PATCH bpf-next v9 02/10] bpf: Add eBPF program subtype and is_valid_subtype() verifier</a></strong>
<ul><li><em>From:</em> Micka&#xEB;l Sala&#xFC;n</li></ul></li>
<li><strong><a name="29355" href="msg29355.html">Re: [PATCH bpf-next v9 02/10] bpf: Add eBPF program subtype and is_valid_subtype() verifier</a></strong>
<ul><li><em>From:</em> Alexei Starovoitov</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg29356.html">Re: [RFC PATCH v5 1/1] Add dm verity root hash pkcs7 sig validation.</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg29358.html">Re: [PATCH v4 0/3] initramfs: add support for xattrs in the initial ram disk</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg29355.html">Re: [PATCH bpf-next v9 02/10] bpf: Add eBPF program subtype and is_valid_subtype() verifier</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg29346.html">[PATCH bpf-next v9 03/10] bpf,landlock: Define an eBPF program type for Landlock hooks</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#29357"><strong>Date</strong></a></li>
<li><a href="index.html#29357"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-users/>[Fedora&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
