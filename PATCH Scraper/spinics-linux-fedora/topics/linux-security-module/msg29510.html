<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode -->
<!--X-From-R13: Oaql Zhgbzvefxv &#60;yhgbNxreary.bet> -->
<!--X-Date: Thu, 27 Jun 2019 16:23:25 &#45;0700 -->
<!--X-Message-Id: CALCETrU7JVH7LR3d_=s&#45;O=b2bjevTLw2rSm5g50UjaUB2PTY5A@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20190621011941.186255&#45;1&#45;matthewgarrett@google.com -->
<!--X-Reference: 20190621011941.186255&#45;25&#45;matthewgarrett@google.com -->
<!--X-Reference: CALCETrVUwQP7roLnW6kFG80Cc5U6X_T6AW+BTAftLccYGp8+Ow@mail.gmail.com -->
<!--X-Reference: alpine.LRH.2.21.1906270621080.28132@namei.org -->
<!--X-Reference: 6E53376F&#45;01BB&#45;4795&#45;BC02&#45;24F9CAE00001@amacapital.net -->
<!--X-Reference: bce70c8b&#45;9efd&#45;6362&#45;d536&#45;cfbbcf70b0b7@tycho.nsa.gov -->
<!--X-Reference: alpine.LRH.2.21.1906280332500.17363@namei.org -->
<!--X-Reference: de8b15eb&#45;ba6c&#45;847a&#45;7435&#45;42742203d4a5@tycho.nsa.gov -->
<!--X-Reference: CACdnJuuG8cR7h9v3pNcBKsxyckAzpKuBJs1GQxsz77jk5DRoQA@mail.gmail.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Linux Security Module, Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Linux Security Module -- Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</title>
<link rel="alternate" type="application/rss+xml" title="Linux Security Module" href="//feeds.feedburner.com/LinuxSecurityModule">
</head>
<body vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</h1>
[<a href="msg29509.html">Date Prev</a>][<a href="msg29511.html">Date Next</a>][<a href="msg29507.html">Thread Prev</a>][<a href="msg29512.html">Thread Next</a>][<a href="maillist.html#29510">Date Index</a>][<a href="index.html#29510">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</li>
<li><em>From</em>: Andy Lutomirski &lt;luto@xxxxxxxxxx&gt;</li>
<li><em>Date</em>: Thu, 27 Jun 2019 16:23:10 -0700</li>
<li><em>Cc</em>: Stephen Smalley &lt;sds@xxxxxxxxxxxxx&gt;, James Morris &lt;jmorris@xxxxxxxxx&gt;,        Andy Lutomirski &lt;luto@xxxxxxxxxx&gt;, linux-security@xxxxxxxxxxxxxxx,        LKML &lt;linux-kernel@xxxxxxxxxxxxxxx&gt;,        Linux API &lt;linux-api@xxxxxxxxxxxxxxx&gt;,        David Howells &lt;dhowells@xxxxxxxxxx&gt;,        Alexei Starovoitov &lt;alexei.starovoitov@xxxxxxxxx&gt;,        Network Development &lt;netdev@xxxxxxxxxxxxxxx&gt;,        Chun-Yi Lee &lt;jlee@xxxxxxxx&gt;, Daniel Borkmann &lt;daniel@xxxxxxxxxxxxx&gt;,        LSM List &lt;linux-security-module@xxxxxxxxxxxxxxx&gt;</li>
<li><em>In-reply-to</em>: &lt;<a href="msg29507.html">CACdnJuuG8cR7h9v3pNcBKsxyckAzpKuBJs1GQxsz77jk5DRoQA@mail.gmail.com</a>&gt;</li>
<li><em>References</em>: &lt;20190621011941.186255-1-matthewgarrett@google.com&gt; &lt;20190621011941.186255-25-matthewgarrett@google.com&gt; &lt;CALCETrVUwQP7roLnW6kFG80Cc5U6X_T6AW+BTAftLccYGp8+Ow@mail.gmail.com&gt; &lt;<a href="msg29394.html">alpine.LRH.2.21.1906270621080.28132@namei.org</a>&gt; &lt;<a href="msg29433.html">6E53376F-01BB-4795-BC02-24F9CAE00001@amacapital.net</a>&gt; &lt;<a href="msg29462.html">bce70c8b-9efd-6362-d536-cfbbcf70b0b7@tycho.nsa.gov</a>&gt; &lt;<a href="msg29477.html">alpine.LRH.2.21.1906280332500.17363@namei.org</a>&gt; &lt;<a href="msg29487.html">de8b15eb-ba6c-847a-7435-42742203d4a5@tycho.nsa.gov</a>&gt; &lt;<a href="msg29507.html">CACdnJuuG8cR7h9v3pNcBKsxyckAzpKuBJs1GQxsz77jk5DRoQA@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On Thu, Jun 27, 2019 at 4:16 PM Matthew Garrett &lt;mjg59@xxxxxxxxxx&gt; wrote:
&gt;
&gt; On Thu, Jun 27, 2019 at 1:16 PM Stephen Smalley &lt;sds@xxxxxxxxxxxxx&gt; wrote:
&gt; &gt; That would only allow the LSM to further lock down the system above the
&gt; &gt; lockdown level set at boot, not grant exemptions for specific
&gt; &gt; functionality/interfaces required by the user or by a specific
&gt; &gt; process/program. You'd have to boot with lockdown=none (or your
&gt; &gt; lockdown=custom suggestion) in order for the LSM to allow anything
&gt; &gt; covered by the integrity or confidentiality levels.  And then the kernel
&gt; &gt; would be unprotected prior to full initialization of the LSM, including
&gt; &gt; policy load.
&gt; &gt;
&gt; &gt; It seems like one would want to be able to boot with lockdown=integrity
&gt; &gt; to protect the kernel initially, then switch over to allowing the LSM to
&gt; &gt; selectively override it.
&gt;
&gt; One option would be to allow modules to be &quot;unstacked&quot; at runtime, but
&gt; there's still something of a problem here - how do you ensure that
&gt; your userland can be trusted to load a new policy before it does so?
&gt; If you're able to assert that your early userland is trustworthy
&gt; (perhaps because it's in an initramfs that's part of your signed boot
&gt; payload), there's maybe an argument that most of the lockdown
&gt; integrity guarantees are unnecessary before handoff - just using the
&gt; lockdown LSM to protect against attacks via kernel parameters would be
&gt; sufficient.

I think that, if you don't trust your system enough to avoid
compromising itself before policy load, then your MAC policy is more
or less dead in the water.  It seems to be that it ought to be good
enough to boot with lockdown=none and then have a real policy loaded
along with the rest of the MAC policy.  Or, for applications that need
to be stricter, you accept that MAC policy can't override lockdown.


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="29394" href="msg29394.html">Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</a></strong>
<ul><li><em>From:</em> James Morris</li></ul></li>
<li><strong><a name="29433" href="msg29433.html">Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</a></strong>
<ul><li><em>From:</em> Andy Lutomirski</li></ul></li>
<li><strong><a name="29462" href="msg29462.html">Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</a></strong>
<ul><li><em>From:</em> Stephen Smalley</li></ul></li>
<li><strong><a name="29477" href="msg29477.html">Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</a></strong>
<ul><li><em>From:</em> James Morris</li></ul></li>
<li><strong><a name="29487" href="msg29487.html">Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</a></strong>
<ul><li><em>From:</em> Stephen Smalley</li></ul></li>
<li><strong><a name="29507" href="msg29507.html">Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</a></strong>
<ul><li><em>From:</em> Matthew Garrett</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg29509.html">Re: [PATCH V34 09/29] kexec_file: Restrict at runtime if the kernel is locked down</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg29511.html">[PATCH] ima: Update MAX_TEMPLATE_NAME_LEN to fit largest reasonable definition</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg29507.html">Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg29512.html">Re: [PATCH V33 24/30] bpf: Restrict bpf when kernel lockdown is in confidentiality mode</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#29510"><strong>Date</strong></a></li>
<li><a href="index.html#29510"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-users/>[Fedora&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
