<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re: [PATCH v4 23/23] AppArmor: Remove the exclusive flag -->
<!--X-From-R13: Xbua Xbunafra &#60;wbua.wbunafraNpnabavpny.pbz> -->
<!--X-Date: Wed, 26 Jun 2019 20:44:48 &#45;0700 -->
<!--X-Message-Id: d89fbbe9&#45;49cb&#45;646e&#45;6cba&#45;7951cf835bf9@canonical.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20190626192234.11725&#45;1&#45;casey@schaufler&#45;ca.com -->
<!--X-Reference: 20190626192234.11725&#45;24&#45;casey@schaufler&#45;ca.com -->
<!--X-Reference: alpine.LRH.2.21.1906271219450.12379@namei.org -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Linux Security Module, Re: [PATCH v4 23/23] AppArmor: Remove the exclusive flag">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Linux Security Module -- Re: [PATCH v4 23/23] AppArmor: Remove the exclusive flag</title>
<link rel="alternate" type="application/rss+xml" title="Linux Security Module" href="//feeds.feedburner.com/LinuxSecurityModule">
</head>
<body vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en"></script>
<h1 itemprop="name">Re: [PATCH v4 23/23] AppArmor: Remove the exclusive flag</h1>
[<a href="msg29438.html">Date Prev</a>][<a href="msg29440.html">Date Next</a>][<a href="msg29438.html">Thread Prev</a>][<a href="msg29441.html">Thread Next</a>][<a href="maillist.html#29439">Date Index</a>][<a href="index.html#29439">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: Re: [PATCH v4 23/23] AppArmor: Remove the exclusive flag</li>
<li><em>From</em>: John Johansen &lt;john.johansen@xxxxxxxxxxxxx&gt;</li>
<li><em>Date</em>: Wed, 26 Jun 2019 20:44:37 -0700</li>
<li><em>Cc</em>: casey.schaufler@xxxxxxxxx, linux-security-module@xxxxxxxxxxxxxxx,        selinux@xxxxxxxxxxxxxxx, keescook@xxxxxxxxxxxx,        penguin-kernel@xxxxxxxxxxxxxxxxxxx, paul@xxxxxxxxxxxxxx,        sds@xxxxxxxxxxxxx</li>
<li><em>In-reply-to</em>: &lt;<a href="msg29435.html">alpine.LRH.2.21.1906271219450.12379@namei.org</a>&gt;</li>
<li><em>Openpgp</em>: preference=signencrypt</li>
<li><em>Organization</em>: Canonical</li>
<li><em>References</em>: &lt;<a href="msg29370.html">20190626192234.11725-1-casey@schaufler-ca.com</a>&gt; &lt;<a href="msg29392.html">20190626192234.11725-24-casey@schaufler-ca.com</a>&gt; &lt;<a href="msg29435.html">alpine.LRH.2.21.1906271219450.12379@namei.org</a>&gt;</li>
<li><em>User-agent</em>: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Thunderbird/60.7.1</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On 6/26/19 7:22 PM, James Morris wrote:
&gt; On Wed, 26 Jun 2019, Casey Schaufler wrote:
&gt; 
&gt;&gt; With the inclusion of the &quot;display&quot; process attribute
&gt;&gt; mechanism AppArmor no longer needs to be treated as an
&gt;&gt; &quot;exclusive&quot; security module. Remove the flag that indicates
&gt;&gt; it is exclusive. Remove the stub getpeersec_dgram AppArmor
&gt;&gt; hook as it has no effect in the single LSM case and
&gt;&gt; interferes in the multiple LSM case.
&gt; 
&gt; So now if I build a kernel with SELinux and AppArmor selected, with 
&gt; SELinux registered first, I now need to use apparmor=0 at the kernel 
&gt; command line to preserve existing behavior (just SELinux running).
&gt; 

AppArmor can be built-in (compiled) without being on the Enabled list.
If you had apparmor in your enabled list along with selinux before,
it would attempt to enabled and fail with the message

  exclusive disabled: apparmor

now it will be enabled but it does match what is documented in
the lsm enabled description

    A comma-separated list of LSMs, in initialization order.
    Any LSMs left off this list will be ignored. This can be
    controlled at boot with the &quot;lsm=&quot; parameter.


what isn't documented is the exclusive behavior and it does
make sense to have which LSMs are exclusive documented somewhere.


&gt; This should at least be documented.
&gt; 
&gt; I wonder if this will break existing users, though.  Who has both 
&gt; currently selected and depends on only one of them being active?
&gt; 

thankfully even if you had apparmor in your lsm enabled list before,
this likely isn't enough to change the system behavior. You will
also need some apparmor policy installed and enough of the
usersoace to load it. Otherwise while apparmor will be enabled it
will come up in unconfined mode.

Even the interfaces /proc/*/attr/* will default to the first
major LSM in the list (in your example selinux). Apparmor's
labeling won't be visible without a task explicitly opting in
to it.


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="29441" href="msg29441.html">Re: [PATCH v4 23/23] AppArmor: Remove the exclusive flag</a></strong>
<ul><li><em>From:</em> James Morris</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="29370" href="msg29370.html">[PATCH v4 00/23] LSM: Module stacking for AppArmor</a></strong>
<ul><li><em>From:</em> Casey Schaufler</li></ul></li>
<li><strong><a name="29392" href="msg29392.html">[PATCH v4 23/23] AppArmor: Remove the exclusive flag</a></strong>
<ul><li><em>From:</em> Casey Schaufler</li></ul></li>
<li><strong><a name="29435" href="msg29435.html">Re: [PATCH v4 23/23] AppArmor: Remove the exclusive flag</a></strong>
<ul><li><em>From:</em> James Morris</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg29438.html">Re: [PATCH v4 23/23] AppArmor: Remove the exclusive flag</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg29440.html">Re: [PATCH v4 00/23] LSM: Module stacking for AppArmor</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg29438.html">Re: [PATCH v4 23/23] AppArmor: Remove the exclusive flag</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg29441.html">Re: [PATCH v4 23/23] AppArmor: Remove the exclusive flag</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#29439"><strong>Date</strong></a></li>
<li><a href="index.html#29439"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-users/>[Fedora&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-desktop/>[Fedora&nbsp;Desktop]</a>
&nbsp;
&nbsp;
<a href=/lists/fedora-selinux/>[Fedora&nbsp;SELinux]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kde/>[KDE&nbsp;Users]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
