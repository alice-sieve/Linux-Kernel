<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re: [PATCH 2/3 v2] dt&#45;bindings: gpio: aspeed: Add SGPIO support -->
<!--X-From-R13: "Oaqerj Xrssrel" &#60;naqerjNnw.vq.nh> -->
<!--X-Date: Sun, 14 Jul 2019 19:25:17 &#45;0700 -->
<!--X-Message-Id: 56d7603a&#45;c1b9&#45;4893&#45;871d&#45;2aee17329e40@www.fastmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1562962440&#45;15908&#45;1&#45;git&#45;send&#45;email&#45;hongweiz@ami.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<meta name="description" content="Linux ARM, OMAP, Xscale Kernel: Re: [PATCH 2/3 v2] dt-bindings: gpio: aspeed: Add SGPIO support">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Re: [PATCH 2/3 v2] dt-bindings: gpio: aspeed: Add SGPIO support &mdash; ARM, OMAP, Xscale Linux Kernel</title>
<link rel="alternate" type="application/rss+xml" title="Linux ARM Kernel" href="//feedproxy.google.com/LinuxArmKernel">
<link rel="alternate" type="application/rss+xml" title="Linux ARM Kernel" href="//feeds.feedburner.com/LinuxArmxscaleEtc">
<link rel="alternate" type="application/rss+xml" title="Fedora ARM" href="//feeds.feedburner.com/FedoraArm">
<link rel="alternate" type="application/rss+xml" title="Linux for OMAP" href="//feedproxy.google.com/LinuxOmap">
</head>
<body itemscope itemtype="//schema.org/Article" vlink=green>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<td align=right><form action="//www.google.com/cse" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:isdiegq275o" />
    <input type="hidden" name="ie" value="ISO-8859-1" />
    <input type="text" name="q" size="37" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/cse/brand?form=cse-search-box&amp;lang=en" async></script>
<h1 itemprop="name">Re: [PATCH 2/3 v2] dt-bindings: gpio: aspeed: Add SGPIO support</h1>
[<a href="msg741043.html">Date Prev</a>][<a href="msg741045.html">Date Next</a>][<a href="msg740988.html">Thread Prev</a>][<a href="msg740991.html">Thread Next</a>][<a href="maillist.html#741044">Date Index</a>][<a href="threads.html#741044">Thread Index</a>] 
<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>Subject</em>: Re: [PATCH 2/3 v2] dt-bindings: gpio: aspeed: Add SGPIO support</li>
<li><em>From</em>: &quot;Andrew Jeffery&quot; &lt;andrew@xxxxxxxx&gt;</li>
<li><em>Date</em>: Mon, 15 Jul 2019 11:55:06 +0930</li>
<li><em>In-reply-to</em>: &lt;<a href="msg740988.html">1562962440-15908-1-git-send-email-hongweiz@ami.com</a>&gt;</li>
<li><em>User-agent</em>: Cyrus-JMAP/3.1.6-731-g19d3b16-fmstable-20190627v1</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hello Hongwei,

On Sat, 13 Jul 2019, at 05:44, Hongwei Zhang wrote:
&gt;<i> Add bindings to support SGPIO on AST2400 or AST2500.</i>
&gt;<i> </i>
&gt;<i> Signed-off-by: Hongwei Zhang &lt;hongweiz@xxxxxxx&gt;</i>
&gt;<i> ---</i>
&gt;<i>  .../devicetree/bindings/gpio/sgpio-aspeed.txt      | 43 ++++++++++++++++++++++</i>
&gt;<i>  1 file changed, 43 insertions(+)</i>
&gt;<i>  create mode 100755 Documentation/devicetree/bindings/gpio/sgpio-aspeed.txt</i>
&gt;<i> </i>
&gt;<i> diff --git a/Documentation/devicetree/bindings/gpio/sgpio-aspeed.txt </i>
&gt;<i> b/Documentation/devicetree/bindings/gpio/sgpio-aspeed.txt</i>
&gt;<i> new file mode 100755</i>
&gt;<i> index 0000000..3ae2b79</i>
&gt;<i> --- /dev/null</i>
&gt;<i> +++ b/Documentation/devicetree/bindings/gpio/sgpio-aspeed.txt</i>
&gt;<i> @@ -0,0 +1,43 @@</i>
&gt;<i> +Aspeed SGPIO controller Device Tree Bindings</i>
&gt;<i> +-------------------------------------------</i>
&gt;<i> +</i>
&gt;<i> +Required properties:</i>
&gt;<i> +- compatible		: Either &quot;aspeed,ast2400-sgpio&quot; or &quot;aspeed,ast2500-sgpio&quot;</i>
&gt;<i> +</i>
&gt;<i> +- #gpio-cells 		: Should be two</i>
&gt;<i> +			  - First cell is the GPIO line number</i>
&gt;<i> +			  - Second cell is used to specify optional</i>
&gt;<i> +			    parameters (unused)</i>
&gt;<i> +</i>
&gt;<i> +- reg			: Address and length of the register set for the device</i>
&gt;<i> +- gpio-controller	: Marks the device node as a GPIO controller.</i>
&gt;<i> +- interrupts		: Interrupt specifier (see interrupt bindings for</i>
&gt;<i> +			  details)</i>
&gt;<i> +</i>
&gt;<i> +- interrupt-controller	: Mark the GPIO controller as an </i>
&gt;<i> interrupt-controller</i>
&gt;<i> +</i>
&gt;<i> +- nr-gpios		: number of GPIO pins to serialise. (should be multiple of </i>
&gt;<i> 8, up to 80 pins)</i>
&gt;<i> +			  if not specified, defaults to 80.</i>

This appears to be a statement about the driver implementation, but bindings
documents are about describing hardware. Reading the datasheet it actually
appears the ASPEED SGPIO hardware comes up in what is &quot;technically&quot; a
forbidden state (equivalent to `nr-gpios = &lt;0&gt;;`), though the device is also
disabled at this point, so it's probably moot. The point is the true default
value from a hardware perspective is 0, not 80, so if we're going to talk about
default values, 0 would be more appropriate. However:

You've also listed nr-gpios under the &quot;Required properties&quot; header, but the
description suggests it's optional. It's either one or the other, please lets be
clear about it. On that front, lets make it nr-gpios *not* optional (i.e. make it
required) thus force the specification of how many SGPIOs we want to emit
on the bus. This value is coupled to the platform design, so I don't think
there's ever a scenario where we want nr-gpios to take a default value.

&gt;<i> +</i>
&gt;<i> +- clocks               : A phandle to the APB clock for SGPM clock </i>
&gt;<i> division</i>
&gt;<i> +</i>
&gt;<i> +- bus-frequency	: SGPM CLK frequency, if not specified defaults to 1 </i>
&gt;<i> MHz</i>

Again here with the default value - SGPM CLK period is derived from PCLK by
the expression `period = PCLK * 2 *(GPIO254[31:16] + 1)`, where GPIO254's
initialisation state is `GPIO254[31:16] = 0`, which gives a default SGPM bus
frequency of PCLK / 2. This is likely not going to be 1MHz (more like ~12MHz).

Lets just make the property required. That way we avoid any ambiguity about
the bus frequency and thus don't need words about defaults that turn out to
be about the driver, not about the hardware.

Finally, when updating patches in response to feedback, please send the full
series again, and bump the series version number. That way people can review
a coherent set of patches and not have to hunt around and (fail to) collate the
correct combination. It makes it easier to say &quot;Reviewed-by:&quot; on your patches :)

Cheers,

Andrew

_______________________________________________
linux-arm-kernel mailing list
linux-arm-kernel@xxxxxxxxxxxxxxxxxxx
<a  rel="nofollow" href="http://lists.infradead.org/mailman/listinfo/linux-arm-kernel">http://lists.infradead.org/mailman/listinfo/linux-arm-kernel</a>


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="740988" href="msg740988.html">[PATCH 2/3 v2] dt-bindings: gpio: aspeed: Add SGPIO support</a></strong>
<ul><li><em>From:</em> Hongwei Zhang</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg741043.html">Re: [GIT PULL] Mailbox changes for v5.3</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg741045.html">Re: [PATCH v2 1/2] dt-bindings: mmc: Document Aspeed SD controller</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg740988.html">[PATCH 2/3 v2] dt-bindings: gpio: aspeed: Add SGPIO support</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg740991.html">[PATCH 1/2] bus: imx-weim: optionally enable burst clock mode</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#741044"><strong>Date</strong></a></li>
<li><a href="threads.html#741044"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/lists/kernel/>[Linux&nbsp;Kernel]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-arm/>[Linux&nbsp;ARM&nbsp;(vger)]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-arm-msm/>[Linux&nbsp;ARM&nbsp;MSM]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-omap/>[Linux&nbsp;Omap]</a>
&nbsp;
&nbsp;
<a href=/lists/centos-arm-devel/>[CentOS&nbsp;ARM]</a>
&nbsp;
&nbsp;
<a href=/lists/arm/>[Linux&nbsp;Arm]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-tegra/>[Linux&nbsp;Tegra]</a>
&nbsp;
&nbsp;
<a href=/linux/fedora/fedora-arm/>[Fedora&nbsp;ARM]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-samsung-soc/>[Linux&nbsp;for&nbsp;Samsung&nbsp;SOC]</a>
&nbsp;
&nbsp;
<a href=/lists/ecos/>[eCos]</a>
&nbsp;
&nbsp;
<a href=/lists/fastboot/>[Linux&nbsp;Fastboot]</a>
&nbsp;
&nbsp;
<a href=/lists/gcchelp/>[Gcc&nbsp;Help]</a>
&nbsp;
&nbsp;
<a href=/lists/git/>[Git]</a>
&nbsp;
&nbsp;
<a href=/lists/dccp/>[DCCP]</a>
&nbsp;
&nbsp;
<a href=/lists/ietf-ann>[IETF&nbsp;Announce]</a>
&nbsp;
&nbsp;
<a href=/lists/security/>[Security]</a>
&nbsp;
&nbsp;
<a href=/lists/mips/>[Linux&nbsp;MIPS]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }

initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
