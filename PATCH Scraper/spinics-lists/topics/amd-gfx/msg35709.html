<!-- MHonArc v2.6.19 -->
<!--X-Subject: RE: [PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command -->
<!--X-From-R13: "Lunat, Vnjxvat" &#60;Vnjxvat.LunatNnzq.pbz> -->
<!--X-Date: Wed, 10 Jul 2019 21:12:50 &#45;0700 -->
<!--X-Message-Id: DM5PR12MB141867D8A862369F2B63C312FCF30@DM5PR12MB1418.namprd12.prod.outlook.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 1562774338&#45;4457&#45;1&#45;git&#45;send&#45;email&#45;Hawking.Zhang@amd.com -->
<!--X-Reference: CADnq5_ODqPSB_2DAeS8amdP3dHNJvO=koZMMncRtWEGBDPA7rg@mail.gmail.com -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="AMD GFX: RE: [PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>RE: [PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command &mdash; Linux AMD GFX</title>
<link rel="alternate" type="application/rss+xml" title="Linux AMD GFX" href="//feeds.feedburner.com/LinuxAmdGraphics">
</head>
<body itemscope itemtype="//schema.org/Article" bgcolor=white vlink=green link=blue>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en" async defer></script>
<h1 itemprop="name">RE: [PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command</h1>
[<a href="msg35708.html">Date Prev</a>][<a href="msg35710.html">Date Next</a>][<a href="msg35700.html">Thread Prev</a>][<a href="msg35721.html">Thread Next</a>][<a href="maillist.html#35709">Date Index</a>][<a href="index.html#35709">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Alex Deucher &lt;alexdeucher@xxxxxxxxx&gt;</li>
<li><em>Subject</em>: RE: [PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command</li>
<li><em>From</em>: &quot;Zhang, Hawking&quot; &lt;Hawking.Zhang@xxxxxxx&gt;</li>
<li><em>Date</em>: Thu, 11 Jul 2019 04:12:43 +0000</li>
<li><em>Accept-language</em>: en-US</li>
<li><em>Cc</em>: &quot;Deucher, Alexander&quot; &lt;Alexander.Deucher@xxxxxxx&gt;,        &quot;Clements, John&quot; &lt;John.Clements@xxxxxxx&gt;,        amd-gfx list &lt;amd-gfx@xxxxxxxxxxxxxxxxxxxxx&gt;,        &quot;Yuan, Xiaojie&quot; &lt;Xiaojie.Yuan@xxxxxxx&gt;</li>
<li><em>In-reply-to</em>: &lt;CADnq5_ODqPSB_2DAeS8amdP3dHNJvO=koZMMncRtWEGBDPA7rg@mail.gmail.com&gt;</li>
<li><em>References</em>: &lt;<a href="msg35698.html">1562774338-4457-1-git-send-email-Hawking.Zhang@amd.com</a>&gt; &lt;CADnq5_ODqPSB_2DAeS8amdP3dHNJvO=koZMMncRtWEGBDPA7rg@mail.gmail.com&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>RE - Maybe this would be better in psp_gfx_if.h since it's sort of part of the firmware interface, but I guess it's not really part of the psp ring interface.

Yes, these cmds are not submitted to the psp ring and actually issued before the psp ring setup. They are not in the internal psp_gfx_if.h files, so I put them in general psp header.

Regards,
Hawking
-----Original Message-----
From: Alex Deucher &lt;alexdeucher@xxxxxxxxx&gt; 
Sent: 2019&#x5E74;7&#x6708;11&#x65E5; 1:25
To: Zhang, Hawking &lt;Hawking.Zhang@xxxxxxx&gt;
Cc: amd-gfx list &lt;amd-gfx@xxxxxxxxxxxxxxxxxxxxx&gt;; Yuan, Xiaojie &lt;Xiaojie.Yuan@xxxxxxx&gt;; Clements, John &lt;John.Clements@xxxxxxx&gt;; Deucher, Alexander &lt;Alexander.Deucher@xxxxxxx&gt;
Subject: Re: [PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command

On Wed, Jul 10, 2019 at 11:59 AM Hawking Zhang &lt;Hawking.Zhang@xxxxxxx&gt; wrote:
&gt;<i></i>

Please add a patch description.

&gt;<i> Change-Id: Ief4c1e5ca01df0a028a784c0faf37544939733a3</i>
&gt;<i> Signed-off-by: Hawking Zhang &lt;Hawking.Zhang@xxxxxxx&gt;</i>
&gt;<i> ---</i>
&gt;<i>  drivers/gpu/drm/amd/amdgpu/amdgpu_psp.h | 9 +++++++++  </i>
&gt;<i> drivers/gpu/drm/amd/amdgpu/psp_v11_0.c  | 4 ++--</i>
&gt;<i>  drivers/gpu/drm/amd/amdgpu/psp_v3_1.c   | 4 ++--</i>
&gt;<i>  3 files changed, 13 insertions(+), 4 deletions(-)</i>
&gt;<i></i>
&gt;<i> diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu_psp.h </i>
&gt;<i> b/drivers/gpu/drm/amd/amdgpu/amdgpu_psp.h</i>
&gt;<i> index e28cf5e..8ddcec1 100644</i>
&gt;<i> --- a/drivers/gpu/drm/amd/amdgpu/amdgpu_psp.h</i>
&gt;<i> +++ b/drivers/gpu/drm/amd/amdgpu/amdgpu_psp.h</i>
&gt;<i> @@ -42,6 +42,15 @@ struct psp_context;  struct psp_xgmi_node_info;  </i>
&gt;<i> struct psp_xgmi_topology_info;</i>
&gt;<i></i>
&gt;<i> +enum psp_bootloader_cmd {</i>
&gt;<i> +       PSP_BL__LOAD_SYSDRV             = 0x10000,</i>
&gt;<i> +       PSP_BL__LOAD_SOSDRV             = 0x20000,</i>
&gt;<i> +       PSP_BL__NO_ECC                  = 0x40000,</i>
&gt;<i> +       PSP_BL__PARTIAL_ECC             = 0x50000,</i>
&gt;<i> +       PSP_BL__FULL_ECC                = 0x60000,</i>
&gt;<i> +       PSP_BL__LOAD_KEY_DATABASE       = 0x80000,</i>
&gt;<i> +};</i>
&gt;<i> +</i>

Maybe this would be better in psp_gfx_if.h since it's sort of part of the firmware interface, but I guess it's not really part of the psp ring interface.  Either way, with the patch description added, the series is:
Reviewed-by: Alex Deucher &lt;alexander.deucher@xxxxxxx&gt;

&gt;<i>  enum psp_ring_type</i>
&gt;<i>  {</i>
&gt;<i>         PSP_RING_TYPE__INVALID = 0,</i>
&gt;<i> diff --git a/drivers/gpu/drm/amd/amdgpu/psp_v11_0.c </i>
&gt;<i> b/drivers/gpu/drm/amd/amdgpu/psp_v11_0.c</i>
&gt;<i> index 1b6c20c..e784091 100644</i>
&gt;<i> --- a/drivers/gpu/drm/amd/amdgpu/psp_v11_0.c</i>
&gt;<i> +++ b/drivers/gpu/drm/amd/amdgpu/psp_v11_0.c</i>
&gt;<i> @@ -212,7 +212,7 @@ static int psp_v11_0_bootloader_load_sysdrv(struct psp_context *psp)</i>
&gt;<i>         /* Provide the sys driver to bootloader */</i>
&gt;<i>         WREG32_SOC15(MP0, 0, mmMP0_SMN_C2PMSG_36,</i>
&gt;<i>                (uint32_t)(psp-&gt;fw_pri_mc_addr &gt;&gt; 20));</i>
&gt;<i> -       psp_gfxdrv_command_reg = 1 &lt;&lt; 16;</i>
&gt;<i> +       psp_gfxdrv_command_reg = PSP_BL__LOAD_SYSDRV;</i>
&gt;<i>         WREG32_SOC15(MP0, 0, mmMP0_SMN_C2PMSG_35,</i>
&gt;<i>                psp_gfxdrv_command_reg);</i>
&gt;<i></i>
&gt;<i> @@ -253,7 +253,7 @@ static int psp_v11_0_bootloader_load_sos(struct psp_context *psp)</i>
&gt;<i>         /* Provide the PSP secure OS to bootloader */</i>
&gt;<i>         WREG32_SOC15(MP0, 0, mmMP0_SMN_C2PMSG_36,</i>
&gt;<i>                (uint32_t)(psp-&gt;fw_pri_mc_addr &gt;&gt; 20));</i>
&gt;<i> -       psp_gfxdrv_command_reg = 2 &lt;&lt; 16;</i>
&gt;<i> +       psp_gfxdrv_command_reg = PSP_BL__LOAD_SOSDRV;</i>
&gt;<i>         WREG32_SOC15(MP0, 0, mmMP0_SMN_C2PMSG_35,</i>
&gt;<i>                psp_gfxdrv_command_reg);</i>
&gt;<i></i>
&gt;<i> diff --git a/drivers/gpu/drm/amd/amdgpu/psp_v3_1.c </i>
&gt;<i> b/drivers/gpu/drm/amd/amdgpu/psp_v3_1.c</i>
&gt;<i> index 3f58277..ec3a056 100644</i>
&gt;<i> --- a/drivers/gpu/drm/amd/amdgpu/psp_v3_1.c</i>
&gt;<i> +++ b/drivers/gpu/drm/amd/amdgpu/psp_v3_1.c</i>
&gt;<i> @@ -153,7 +153,7 @@ static int psp_v3_1_bootloader_load_sysdrv(struct psp_context *psp)</i>
&gt;<i>         /* Provide the sys driver to bootloader */</i>
&gt;<i>         WREG32_SOC15(MP0, 0, mmMP0_SMN_C2PMSG_36,</i>
&gt;<i>                (uint32_t)(psp-&gt;fw_pri_mc_addr &gt;&gt; 20));</i>
&gt;<i> -       psp_gfxdrv_command_reg = 1 &lt;&lt; 16;</i>
&gt;<i> +       psp_gfxdrv_command_reg = PSP_BL__LOAD_SYSDRV;</i>
&gt;<i>         WREG32_SOC15(MP0, 0, mmMP0_SMN_C2PMSG_35,</i>
&gt;<i>                psp_gfxdrv_command_reg);</i>
&gt;<i></i>
&gt;<i> @@ -216,7 +216,7 @@ static int psp_v3_1_bootloader_load_sos(struct psp_context *psp)</i>
&gt;<i>         /* Provide the PSP secure OS to bootloader */</i>
&gt;<i>         WREG32_SOC15(MP0, 0, mmMP0_SMN_C2PMSG_36,</i>
&gt;<i>                (uint32_t)(psp-&gt;fw_pri_mc_addr &gt;&gt; 20));</i>
&gt;<i> -       psp_gfxdrv_command_reg = 2 &lt;&lt; 16;</i>
&gt;<i> +       psp_gfxdrv_command_reg = PSP_BL__LOAD_SOSDRV;</i>
&gt;<i>         WREG32_SOC15(MP0, 0, mmMP0_SMN_C2PMSG_35,</i>
&gt;<i>                psp_gfxdrv_command_reg);</i>
&gt;<i></i>
&gt;<i> --</i>
&gt;<i> 2.7.4</i>
&gt;<i></i>
&gt;<i> _______________________________________________</i>
&gt;<i> amd-gfx mailing list</i>
&gt;<i> amd-gfx@xxxxxxxxxxxxxxxxxxxxx</i>
&gt;<i> <a  rel="nofollow" href="https://lists.freedesktop.org/mailman/listinfo/amd-gfx">https://lists.freedesktop.org/mailman/listinfo/amd-gfx</a></i>
_______________________________________________
amd-gfx mailing list
amd-gfx@xxxxxxxxxxxxxxxxxxxxx
<a  rel="nofollow" href="https://lists.freedesktop.org/mailman/listinfo/amd-gfx">https://lists.freedesktop.org/mailman/listinfo/amd-gfx</a>



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="35721" href="msg35721.html">RE: [PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command</a></strong>
<ul><li><em>From:</em> Zhang, Hawking</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="35698" href="msg35698.html">[PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command</a></strong>
<ul><li><em>From:</em> Hawking Zhang</li></ul></li>
<li><strong><a name="35700" href="msg35700.html">Re: [PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command</a></strong>
<ul><li><em>From:</em> Alex Deucher</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg35708.html">Re: [PATCH 02/10] drm/dp_mst: Enable registration of AUX devices for MST ports (v2)</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg35710.html">Re: [PATCH 2/2] drm/amdgpu: support key database loading for navi10</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg35700.html">Re: [PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg35721.html">RE: [PATCH 1/2] drm/amdgpu: switch to macro for psp bootloader command</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#35709"><strong>Date</strong></a></li>
<li><a href="index.html#35709"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-usb/>[Linux&nbsp;USB&nbsp;Devel]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-audio-users/>[Linux&nbsp;Audio&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info/>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kernel/>[Linux&nbsp;Kernel]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-scsi/>[Linux&nbsp;SCSI]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
