<!-- MHonArc v2.6.19 -->
<!--X-Subject: Re: [PATCH] drm/amd/powerplay: work around enum conversion warnings -->
<!--X-From-R13: Oeaq Pretznaa &#60;neaqNneaqo.qr> -->
<!--X-Date: Mon, 8 Jul 2019 09:07:25 &#45;0700 -->
<!--X-Message-Id: CAK8P3a0ZVqEYCxoCOcAgJL7oV+su0=eZu_XR6X+9vcXzGDwVSQ@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20190708135725.844960&#45;1&#45;arnd@arndb.de -->
<!--X-Reference: 20190708145430.GC43693@archlinux&#45;epyc -->
<!--X-Head-End-->
<!doctype html public "-//W3C//DTD HTML//EN">
<html>
<head>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3422782820843221",
          enable_page_level_ads: true
     });
</script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="AMD GFX: Re: [PATCH] drm/amd/powerplay: work around enum conversion warnings">
<style>
<!--
 pre {white-space: pre-wrap;}
-->
</style>
<title>Re: [PATCH] drm/amd/powerplay: work around enum conversion warnings &mdash; Linux AMD GFX</title>
<link rel="alternate" type="application/rss+xml" title="Linux AMD GFX" href="//feeds.feedburner.com/LinuxAmdGraphics">
</head>
<body itemscope itemtype="//schema.org/Article" bgcolor=white vlink=green link=blue>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<form action="//www.google.com" id="cse-search-box" target="_blank">
  <div>
    <input type="hidden" name="cx" value="partner-pub-3422782820843221:9580497365" />
    <input type="hidden" name="ie" value="UTF-8" />
    <input type="text" name="q" size="25" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="//www.google.com/coop/cse/brand?form=cse-search-box&amp;lang=en" async defer></script>
<h1 itemprop="name">Re: [PATCH] drm/amd/powerplay: work around enum conversion warnings</h1>
[<a href="msg35633.html">Date Prev</a>][<a href="msg35635.html">Date Next</a>][<a href="msg35621.html">Thread Prev</a>][<a href="msg35832.html">Thread Next</a>][<a href="maillist.html#35634">Date Index</a>][<a href="index.html#35634">Thread Index</a>]


<p>&nbsp;<br>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive test for archives -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="6345952567"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Nathan Chancellor &lt;natechancellor@xxxxxxxxx&gt;</li>
<li><em>Subject</em>: Re: [PATCH] drm/amd/powerplay: work around enum conversion warnings</li>
<li><em>From</em>: Arnd Bergmann &lt;arnd@xxxxxxxx&gt;</li>
<li><em>Date</em>: Mon, 8 Jul 2019 18:05:06 +0200</li>
<li><em>Cc</em>: &quot;David \(ChunMing\) Zhou&quot; &lt;David1.Zhou@xxxxxxx&gt;,        Gui Chengming &lt;Jack.Gui@xxxxxxx&gt;, David Airlie &lt;airlied@xxxxxxxx&gt;,        Kevin Wang &lt;kevin1.wang@xxxxxxx&gt;,        Linux Kernel Mailing List &lt;linux-kernel@xxxxxxxxxxxxxxx&gt;,        amd-gfx@xxxxxxxxxxxxxxxxxxxxx,        clang-built-linux &lt;clang-built-linux@xxxxxxxxxxxxxxxx&gt;,        Huang Rui &lt;ray.huang@xxxxxxx&gt;,        dri-devel &lt;dri-devel@xxxxxxxxxxxxxxxxxxxxx&gt;,        Daniel Vetter &lt;daniel@xxxxxxxx&gt;,        Alex Deucher &lt;alexander.deucher@xxxxxxx&gt;,        Likun Gao &lt;Likun.Gao@xxxxxxx&gt;, Evan Quan &lt;evan.quan@xxxxxxx&gt;,        Rex Zhu &lt;rex.zhu@xxxxxxx&gt;,        Christian K&#xF6;nig &lt;christian.koenig@xxxxxxx&gt;,        Hawking Zhang &lt;Hawking.Zhang@xxxxxxx&gt;</li>
<li><em>In-reply-to</em>: &lt;20190708145430.GC43693@archlinux-epyc&gt;</li>
<li><em>References</em>: &lt;<a href="msg35608.html">20190708135725.844960-1-arnd@arndb.de</a>&gt; &lt;20190708145430.GC43693@archlinux-epyc&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<!-- AddThis Button BEGIN -->
<div class="addthis_toolbox addthis_default_style ">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5196c2ae1be43d18&async=1&domready=1" async></script>
<!-- AddThis Button END -->
<hr>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive link 1 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="8681825769"
     data-ad-format="link"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
<p>
<div class="content" itemprop="articleBody">
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On Mon, Jul 8, 2019 at 4:54 PM Nathan Chancellor
&lt;natechancellor@xxxxxxxxx&gt; wrote:
&gt;<i></i>
&gt;<i> Hi Arnd,</i>
&gt;<i></i>
&gt;<i> On Mon, Jul 08, 2019 at 03:57:06PM +0200, Arnd Bergmann wrote:</i>
&gt;<i> &gt; A couple of calls to smu_get_current_clk_freq() and smu_force_clk_levels()</i>
&gt;<i> &gt; pass constants of the wrong type, leading to warnings with clang-8:</i>
&gt;<i> &gt;</i>
&gt;<i> &gt; drivers/gpu/drm/amd/amdgpu/../powerplay/vega20_ppt.c:995:39: error: implicit conversion from enumeration type 'PPCLK_e' to different enumeration type 'enum smu_clk_type' [-Werror,-Wenum-conversion]</i>
&gt;<i> &gt;                 ret = smu_get_current_clk_freq(smu, PPCLK_SOCCLK, &amp;now);</i>
&gt;<i> &gt;                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~</i>
&gt;<i> &gt; drivers/gpu/drm/amd/amdgpu/../powerplay/inc/amdgpu_smu.h:775:82: note: expanded from macro 'smu_get_current_clk_freq'</i>
&gt;<i> &gt;         ((smu)-&gt;funcs-&gt;get_current_clk_freq? (smu)-&gt;funcs-&gt;get_current_clk_freq((smu), (clk_id), (value)) : 0)</i>
&gt;<i> &gt;</i>
&gt;<i> &gt; I could not figure out what the purpose is of mixing the types</i>
&gt;<i> &gt; like this and if it is written like this intentionally.</i>
&gt;<i> &gt; Assuming this is all correct, adding an explict case is an</i>
&gt;<i> &gt; easy way to shut up the warnings.</i>
&gt;<i> &gt;</i>
&gt;<i> &gt; Fixes: bc0fcffd36ba (&quot;drm/amd/powerplay: Unify smu handle task function (v2)&quot;)</i>
&gt;<i> &gt; Fixes: 096761014227 (&quot;drm/amd/powerplay: support sysfs to get socclk, fclk, dcefclk&quot;)</i>
&gt;<i> &gt; Signed-off-by: Arnd Bergmann &lt;arnd@xxxxxxxx&gt;</i>
&gt;<i></i>
&gt;<i> I sent a series last week for all of the clang warnings that were added</i>
&gt;<i> in this driver recently.</i>
&gt;<i></i>
&gt;<i> <a  rel="nofollow" href="https://lore.kernel.org/lkml/20190704055217.45860-1-natechancellor@xxxxxxxxx/">https://lore.kernel.org/lkml/20190704055217.45860-1-natechancellor@xxxxxxxxx/</a></i>
&gt;<i></i>
&gt;<i> I think it is safe to use the CLK enums from the expected type (from</i>
&gt;<i> what I could see from going down the code flow rabbit hole).</i>
&gt;<i></i>
&gt;<i> <a  rel="nofollow" href="https://lore.kernel.org/lkml/20190704055217.45860-4-natechancellor@xxxxxxxxx/">https://lore.kernel.org/lkml/20190704055217.45860-4-natechancellor@xxxxxxxxx/</a></i>
&gt;<i></i>
&gt;<i> <a  rel="nofollow" href="https://lore.kernel.org/lkml/20190704055217.45860-7-natechancellor@xxxxxxxxx/">https://lore.kernel.org/lkml/20190704055217.45860-7-natechancellor@xxxxxxxxx/</a></i>

I tried that at first but concluded that it could not work because the constants
are different. Either it's currently broken and you patches fix the runtime
behavior, or it's currently correct and your patches break it.

        Arnd
_______________________________________________
amd-gfx mailing list
amd-gfx@xxxxxxxxxxxxxxxxxxxxx
<a  rel="nofollow" href="https://lists.freedesktop.org/mailman/listinfo/amd-gfx">https://lists.freedesktop.org/mailman/listinfo/amd-gfx</a>



</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
</div>
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="35832" href="msg35832.html">Re: [PATCH] drm/amd/powerplay: work around enum conversion warnings</a></strong>
<ul><li><em>From:</em> Arnd Bergmann</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="35608" href="msg35608.html">[PATCH] drm/amd/powerplay: work around enum conversion warnings</a></strong>
<ul><li><em>From:</em> Arnd Bergmann</li></ul></li>
<li><strong><a name="35621" href="msg35621.html">Re: [PATCH] drm/amd/powerplay: work around enum conversion warnings</a></strong>
<ul><li><em>From:</em> Nathan Chancellor</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg35633.html">Re: [1/2] drm/amd/powerplay: smu_v11_0: fix uninitialized variable use</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg35635.html">Re: [PATCH] drm/amdgpu: Fix build errors with HMM disabled</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg35621.html">Re: [PATCH] drm/amd/powerplay: work around enum conversion warnings</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg35832.html">Re: [PATCH] drm/amd/powerplay: work around enum conversion warnings</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#35634"><strong>Date</strong></a></li>
<li><a href="index.html#35634"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<center>
<font size=-1>
<a href=/lists/>[Index&nbsp;of&nbsp;Archives]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-usb/>[Linux&nbsp;USB&nbsp;Devel]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-audio-users/>[Linux&nbsp;Audio&nbsp;Users]</a>
&nbsp;
&nbsp;
<a href=https://yosemitenews.info/>[Yosemite&nbsp;News]</a>
&nbsp;
&nbsp;
<a href=/lists/kernel/>[Linux&nbsp;Kernel]</a>
&nbsp;
&nbsp;
<a href=/lists/linux-scsi/>[Linux&nbsp;SCSI]</a>
</font>
</center>
<hr>
<p>
<div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-3422782820843221"
     data-ad-slot="1424524564"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
<table width=100%>
<tr>
<td align=left>&nbsp;</td>
<td align=right><a href=/lists/><img src=/button_01.gif border=0 alt="Powered by Linux"></a></td>
</tr>
</table>
<!--X-User-Footer-End-->
<script type="text/javascript"> 
 function initAddThis() {
    addthis.init()
 }
initAddThis();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-760190-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
